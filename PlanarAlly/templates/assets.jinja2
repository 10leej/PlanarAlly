<!doctype html>
<html>
<head>
    <title>PlanarAlly - Asset Manager</title>
    <script src='/static/extern/js/socket.io-2.0.4.js'></script>
    <script>
        const socket = io.connect(location.protocol + "//" + location.host + "/pa_assetmgmt");
        socket.on("connect", function () {
            console.log("Connected");
        });
        socket.on("disconnect", function () {
            console.log("Disconnected");
        });
        socket.on("redirect", function (destination) {
            console.log("redirecting");
            window.location.href = destination;
        });

        function upload() {
            const fls = $("input").files;
            for(let i=0; i < fls.length; i++) {
                const fr = new FileReader();
                fr.readAsArrayBuffer(fls[i]);
                fr.onload = (e) => {
                    socket.emit("uploadAsset", {
                        name: fls[i].name,
                        type: fls[i].type,
                        size: fls[i].size,
                        data: fr.result
                    });
                }
            }
        }
    </script>
</head>
<body>
{{ asset_info }}
<input type='file' multiple>
</body>
</html>