(function(t){function e(e){for(var s,a,r=e[0],l=e[1],c=e[2],h=0,d=[];h<r.length;h++)a=r[h],o[a]&&d.push(o[a][0]),o[a]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);u&&u(e);while(d.length)d.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],s=!0,r=1;r<i.length;r++){var l=i[r];0!==o[l]&&(s=!1)}s&&(n.splice(e--,1),t=a(a.s=i[0]))}return t}var s={},o={app:0},n=[];function a(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=s,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)a.d(i,s,function(e){return t[e]}.bind(null,s));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("cd49")},"0f76":function(t,e,i){"use strict";var s=i("74a7"),o=i.n(s);o.a},1:function(t,e){},1133:function(t,e,i){},"12d3":function(t,e,i){"use strict";var s=i("a260"),o=i.n(s);o.a},"1d0a":function(t,e,i){},"21c7":function(t,e,i){"use strict";var s=i("6a9b"),o=i.n(s);o.a},2391:function(t,e,i){},"239b":function(t,e,i){"use strict";var s=i("96f6"),o=i.n(s);o.a},"2c85":function(t,e,i){},4370:function(t,e,i){"use strict";var s=i("b5c7"),o=i.n(s);o.a},"451f":function(t,e,i){},"492e":function(t,e,i){},5552:function(t,e,i){},"561b":function(t,e,i){"use strict";var s=i("a450"),o=i.n(s);o.a},"57f2":function(t,e,i){"use strict";var s=i("ff44"),o=i.n(s);o.a},"6a9b":function(t,e,i){},"74a7":function(t,e,i){},7554:function(t,e,i){},7741:function(t,e,i){"use strict";var s=i("7f97"),o=i.n(s);o.a},"7b4f":function(t,e,i){"use strict";var s=i("ef01"),o=i.n(s);o.a},"7f1e":function(t,e,i){"use strict";var s=i("fe11"),o=i.n(s);o.a},"7f97":function(t,e,i){},"7fc2":function(t,e,i){"use strict";var s=i("1133"),o=i.n(s);o.a},"8e03":function(t,e,i){"use strict";var s=i("451f"),o=i.n(s);o.a},"96f6":function(t,e,i){},"986f":function(t,e,i){},a260:function(t,e,i){},a450:function(t,e,i){},a6ac:function(t,e,i){"use strict";var s=i("986f"),o=i.n(s);o.a},b198:function(t,e,i){"use strict";var s=i("2391"),o=i.n(s);o.a},b346:function(t,e,i){},b5c7:function(t,e,i){},c25a:function(t,e,i){"use strict";var s=i("1d0a"),o=i.n(s);o.a},c730:function(t,e,i){"use strict";var s=i("7554"),o=i.n(s);o.a},cd49:function(t,e,i){"use strict";i.r(e);var s=i("a026"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view",{ref:"activeComponent"})],1)},n=[],a=i("2877"),r={},l=Object(a["a"])(r,o,n,!1,null,null,null);l.options.__file="App.vue";var c=l.exports,u=i("bc3a"),h=i.n(u),d=i("8c4f"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{on:{focusin:t.focusin,focusout:t.focusout,submit:function(e){return e.preventDefault(),t.login(e)}}},[i("fieldset",[i("legend",{staticClass:"legend"},[t._v("PlanarAlly")]),i("div",{staticClass:"input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",name:"username",placeholder:"Username",required:""},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),t._m(0)]),i("div",{staticClass:"input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",name:"password",placeholder:"Password",required:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._m(1)]),i("div",{staticStyle:{display:"flex"}},[i("button",{staticStyle:{visibility:"hidden",display:"none"},attrs:{type:"submit",name:"login"}}),i("button",{staticClass:"submit",attrs:{type:"button",name:"register",title:"Register"},on:{click:t.register}},[i("i",{staticClass:"fas fa-plus"})]),t._m(2)])]),t.error?i("div",{staticClass:"feedback"},[i("p",{staticClass:"error"},[i("strong",[t._v("Error:")]),t._v(t._s(t.error))])]):t._e()])},f=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[i("i",{staticClass:"fas fa-user-circle"})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[i("i",{staticClass:"fas fa-lock"})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"submit",attrs:{type:"submit",name:"login",title:"Login"}},[i("i",{staticClass:"fas fa-arrow-right"})])}],m=i("9ab4"),v=i("65d9"),g=i.n(v);let y=class extends s["default"]{constructor(){super(...arguments),this.username="",this.password="",this.error=""}login(){h.a.post("/api/login",{username:this.username,password:this.password}).then(t=>{this.$store.commit("setAuthenticated",!0),this.$router.push(this.$route.query.redirect||"/")}).catch(t=>{t.response?this.error=t.response.statusText:this.error="Unknown error occured"})}register(){h.a.post("/api/register",{username:this.username,password:this.password}).then(t=>{this.$store.commit("setAuthenticated",!0)}).catch(t=>{t.response?this.error=t.response.statusText:this.error="Unknown error occured"})}focusin(t){if(t.target&&t.target.nextElementSibling){const e=t.target.nextElementSibling;e.style.opacity="0"}}focusout(t){if(t.target&&t.target.nextElementSibling){const e=t.target.nextElementSibling;e.style.opacity="1"}}};y=m["a"]([g.a],y);var w=y,x=w,b=(i("d45f"),i("7b4f"),Object(a["a"])(x,p,f,!1,null,"af17832e",null));b.options.__file="login.vue";var S=b.exports,_=i("2f62");s["default"].use(_["a"]);var C=new _["a"].Store({});let k=class extends s["default"]{beforeRouteEnter(t,e,i){h.a.post("/api/logout").then(()=>{C.commit("setAuthenticated",!1),i({path:"/auth/login"})})}};k=m["a"]([g.a],k);var P=k,L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._v(" "+t._s(t.message)+" ")])},O=[],M=s["default"].component("Load",{data:()=>({message:"Loading..."})}),$=M,I=Object(a["a"])($,L,O,!1,null,null,null);I.options.__file="load.vue";var D=I.exports,z=i("6fc5");let T=class extends z["d"]{constructor(){super(...arguments),this.authenticated=!1,this.initialized=!1}setAuthenticated(t){this.authenticated=t}setInitialized(t){this.initialized=t}};m["a"]([z["c"]],T.prototype,"setAuthenticated",null),m["a"]([z["c"]],T.prototype,"setInitialized",null),T=m["a"]([Object(z["b"])({dynamic:!0,store:C,name:"core"})],T);var A=Object(z["e"])(T),N=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"formcontainer"}},[t.owned||t.joined?i("form",[i("fieldset",[i("legend",{staticClass:"legend"},[t._v("Your sessions")]),i("div",{staticClass:"input"},[t._l(t.owned,function(e,s){return i("router-link",{key:"o-"+s,attrs:{to:"/game/"+e[1]+"/"+e[0]}},[t._v(t._s(e[0]))])}),t._l(t.joined,function(e,s){return i("router-link",{key:"j-"+s,attrs:{to:"/game/"+e[1]+"/"+e[0]}},[t._v(t._s(e[1])+"/"+t._s(e[0]))])})],2)])]):t._e(),t._m(0),i("form",{on:{submit:function(e){return e.preventDefault(),t.createRoom(e)}}},[i("fieldset",[t.owned||t.joined?i("div",{staticClass:"input"},[t._v("Create a new session")]):i("legend",{staticClass:"legend"},[t._v("Create a session")]),t._m(1),t._m(2)])]),i("div",{attrs:{id:"account-options"}},[i("form",{on:{submit:function(t){t.preventDefault()}}},[i("router-link",{staticClass:"submit",attrs:{tag:"button",title:"Account Settings",to:"/account"}},[i("i",{staticClass:"fas fa-cog"})])],1),i("form",{on:{submit:function(t){t.preventDefault()}}},[i("router-link",{staticClass:"submit",attrs:{tag:"button",title:"Logout",to:"/auth/logout"}},[i("i",{staticClass:"fas fa-sign-out-alt"})])],1)])])},B=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("h4",[i("span",[t._v("OR")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"input"},[i("input",{attrs:{type:"text",name:"room_name",placeholder:"Session Name"}}),i("span",[i("i",{staticClass:"fab fa-d-and-d"})])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"submit",attrs:{type:"submit",title:"Create"}},[i("i",{staticClass:"fas fa-arrow-right"})])}];g.a.registerHooks(["beforeRouteEnter"]);let R=class extends s["default"]{constructor(){super(...arguments),this.owned=[],this.joined=[],this.error=""}beforeRouteEnter(t,e,i){h.a.get("/api/rooms").then(t=>{i(e=>{e.owned=t.data.owned,e.joined=t.data.joined})}).catch(t=>{i(e=>{e.error=t.message})})}};R=m["a"]([g.a],R);var U=R,E=U,F=(i("d8a6"),Object(a["a"])(E,N,B,!1,null,null,null));F.options.__file="main.vue";var H=F.exports,G=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"main"},on:{mouseleave:t.mouseleave}},[i("div",{attrs:{id:"board"}},[t.ready.manager?[i("tool-bar",{ref:"tools"})]:t._e(),i("div",{attrs:{id:"layers"},on:{mousedown:t.mousedown,mouseup:t.mouseup,mousemove:t.mousemove,contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.contextmenu(e)},dragover:function(t){t.preventDefault()},drop:t.drop}})],2),i("selection-info",{ref:"selectionInfo"}),i("initiative-dialog",{ref:"initiative",attrs:{id:"initiativedialog"}})],1)},W=[],j=i("6f79"),V=i.n(j),Y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{visible:t.visible},on:{close:t.close},scopedSlots:t._u([{key:"header",fn:function(e){return i("div",{staticClass:"modal-header",attrs:{draggable:"true"},on:{dragstart:e.dragStart,dragend:e.dragEnd}},[t._v("\n        "+t._s(t.title)+"\n    ")])}}])},[i("div",{staticClass:"modal-body"},[i("button",{ref:"confirm",on:{click:t.confirm}},[t._v(t._s(t.yes))]),t.no?i("button",{on:{click:t.deny}},[t._v(t._s(t.no))]):t._e()])])},X=[],q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"modal"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"mask",class:{"modal-mask":t.mask,"dialog-mask":!t.mask},on:{click:t.close,dragover:function(e){return e.preventDefault(),t.dragOver(e)}}},[i("div",{ref:"container",staticClass:"modal-container",on:{click:function(t){t.stopPropagation()}}},[t._t("header",null,{dragStart:t.dragStart,dragEnd:t.dragEnd}),t._t("default")],2)])])},J=[],Z=s["default"].extend({props:{visible:Boolean,mask:{type:Boolean,default:!0}},data:()=>({positioned:!1,offsetX:0,offsetY:0,screenX:0,screenY:0,dragging:!1}),mounted(){this.updatePosition()},updated(){this.updatePosition()},methods:{close(t){this.$emit("close")},updatePosition(){if(!this.positioned){const t=this.$refs.container;if(0===t.offsetWidth&&0===t.offsetHeight)return;this.$refs.container.style.left=(window.innerWidth-t.offsetWidth)/2+"px",this.$refs.container.style.top=(window.innerHeight-t.offsetHeight)/2+"px",this.positioned=!0}},dragStart(t){null!==t&&null!==t.dataTransfer&&(t.dataTransfer.setData("Hack",""),t.dataTransfer.setDragImage(this.$refs.container,t.offsetX,t.offsetY),this.offsetX=t.offsetX,this.offsetY=t.offsetY,this.screenX=t.screenX,this.screenY=t.screenY,this.dragging=!0)},dragEnd(t){this.dragging=!1;let e=t.clientX-this.offsetX,i=t.clientY-this.offsetY;0===t.clientX&&0===t.clientY&&0===t.pageX&&0===t.pageY&&(e=parseInt(this.$refs.container.style.left,10)-(this.screenX-t.screenX),i=parseInt(this.$refs.container.style.top,10)-(this.screenY-t.screenY)),e<0&&(e=0),e>window.innerWidth-100&&(e=window.innerWidth-100),i<0&&(i=0),i>window.innerHeight-100&&(i=window.innerHeight-100),this.$refs.container.style.left=e+"px",this.$refs.container.style.top=i+"px",this.$refs.container.style.display="block"},dragOver(t){this.dragging&&(this.$refs.container.style.display="none")}}}),K=Z,Q=(i("c25a"),Object(a["a"])(K,q,J,!1,null,"0f7d191f",null));Q.options.__file="modal.vue";var tt=Q.exports,et={components:{modal:tt},data:()=>({visible:!1,yes:"Yes",no:"No",title:""}),methods:{confirm(){this.resolve(!0),this.close()},deny(){this.resolve(!1),this.close()},close(){this.reject(),this.visible=!1,this.title=""},open(t,e,i){return this.yes=void 0===e?"Yes":e,this.no=void 0===i?"No":i,this.title=t,this.visible=!0,this.$nextTick(function(){this.$refs.confirm.focus()}.bind(this)),new Promise((t,e)=>{this.resolve=t,this.reject=e})}}},it=et,st=(i("e5a8"),Object(a["a"])(it,Y,X,!1,null,"7c994a10",null));st.options.__file="confirm.vue";var ot=st.exports,nt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{visible:t.visible},on:{close:t.close},scopedSlots:t._u([{key:"header",fn:function(e){return i("div",{staticClass:"modal-header",attrs:{draggable:"true"},on:{dragstart:e.dragStart,dragend:e.dragEnd}},[t._v("\n        "+t._s(t.title)+"\n    ")])}}])},[i("div",{staticClass:"modal-body"},[t._v("\n        "+t._s(t.question)+" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.answer,expression:"answer"}],ref:"answer",attrs:{type:"text"},domProps:{value:t.answer},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null},input:function(e){e.target.composing||(t.answer=e.target.value)}}})]),i("div",{staticClass:"modal-footer"},[i("button",{on:{click:t.submit}},[t._v("Submit")])])])},at=[],rt={components:{modal:tt},data:()=>({visible:!1,question:"",answer:"",title:""}),methods:{submit(){this.resolve(this.answer),this.close()},close(){this.reject(),this.visible=!1,this.question="",this.answer="",this.title=""},prompt(t,e){return this.question=t,this.title=e,this.visible=!0,this.$nextTick(function(){this.$refs.answer.focus()}.bind(this)),new Promise((t,e)=>{this.resolve=t,this.reject=e})}}},lt=rt,ct=(i("7741"),Object(a["a"])(lt,nt,at,!1,null,"619acb01",null));ct.options.__file="prompt.vue";var ut=ct.exports;class ht{constructor(t,e){this.x=t,this.y=e}add(t){return new ht(this.x+t.x,this.y+t.y)}subtract(t){return new ft(this.x-t.x,this.y-t.y)}clone(){return new ht(this.x,this.y)}get(t){return 0===t?this.x:this.y}}class dt extends ht{add(t){return super.add(t)}subtract(t){return super.subtract(t)}clone(){return super.clone()}}class pt extends ht{add(t){return super.add(t)}subtract(t){return super.subtract(t)}clone(){return super.clone()}}class ft{constructor(t,e){this.x=t,this.y=e}dot(t){return this.x*t.x+this.y*t.y}inverse(){return new ft(1/this.x,1/this.y)}length(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}normalize(){const t=this.length();return new ft(this.x/t,this.y/t)}reverse(){return new ft(-this.x,-this.y)}multiply(t){return new ft(this.x*t,this.y*t)}}class mt{constructor(t,e,i){this.direction=e,this.origin=t,void 0===i&&(i=1/0),this.tMax=i}static fromPoints(t,e){const i=new ft(e.x-t.x,e.y-t.y);let s;return s=Math.abs(i.x)>.01?(e.x-t.x)/i.x:(e.y-t.y)/i.y,new mt(t,i,s)}get(t){return new ht(this.origin.x+t*this.direction.x,this.origin.y+t*this.direction.y)}getDistance(t,e){return Math.sqrt(Math.pow(e-t,2)*(Math.pow(this.direction.x,2)+Math.pow(this.direction.y,2)))}getT(t,e){return t+Math.sqrt(Math.pow(e,2)/(Math.pow(this.direction.x,2)+Math.pow(this.direction.y,2)))}}class vt{constructor(t,e,i){this.w=e,this.h=i,this.topLeft=t,this.topRight=new dt(t.x+e,t.y),this.botRight=new dt(t.x+e,t.y+i),this.botLeft=new dt(t.x,t.y+i)}contains(t){return this.topLeft.x<=t.x&&this.topRight.x>=t.x&&this.topLeft.y<=t.y&&this.botLeft.y>=t.y}offset(t){return new vt(this.topLeft.add(t),this.w,this.h)}union(t){const e=Math.min(this.topLeft.x,t.topLeft.x),i=Math.max(this.topRight.x,t.topRight.x),s=Math.min(this.topLeft.y,t.topLeft.y),o=Math.max(this.botLeft.y,t.botLeft.y);return new vt(new dt(e,s),i-e,o-s)}getDiagCorner(t){return t?this.botRight:this.topLeft}intersectsWith(t){return!(t.topLeft.x>this.topRight.x||t.topRight.x<this.topLeft.x||t.topLeft.y>this.botLeft.y||t.botLeft.y<this.topLeft.y)}intersectsWithInner(t){return!(t.topLeft.x>=this.topRight.x||t.topRight.x<=this.topLeft.x||t.topLeft.y>=this.botLeft.y||t.botLeft.y<=this.topLeft.y)}intersectP(t,e,i){let s=e.x*(this.getDiagCorner(i[0]).x-t.origin.x),o=e.x*(this.getDiagCorner(!i[0]).x-t.origin.x);const n=e.y*(this.getDiagCorner(i[1]).y-t.origin.y),a=e.y*(this.getDiagCorner(!i[1]).y-t.origin.y);return s>a||n>o?{hit:!1,min:s,max:o}:(n>s&&(s=n),a<o&&(o=a),{hit:s<t.tMax&&o>0,min:s,max:o})}center(t){if(void 0===t)return this.topLeft.add(new ft(this.w/2,this.h/2));this.topLeft.x=t.x-this.w/2,this.topLeft.y=t.y-this.h/2}inCorner(t,e){const i=Math.min(6,this.w/2)/2;switch(e){case"ne":return this.topRight.x-i<=t.x&&t.x<=this.topRight.x+i&&this.topLeft.y-i<=t.y&&t.y<=this.topLeft.y+i;case"nw":return this.topLeft.x-i<=t.x&&t.x<=this.topLeft.x+i&&this.topLeft.y-i<=t.y&&t.y<=this.topLeft.y+i;case"sw":return this.topLeft.x-i<=t.x&&t.x<=this.topLeft.x+i&&this.botLeft.y-i<=t.y&&t.y<=this.botLeft.y+i;case"se":return this.topRight.x-i<=t.x&&t.x<=this.topRight.x+i&&this.botLeft.y-i<=t.y&&t.y<=this.botLeft.y+i;default:return!1}}getCorner(t){return this.inCorner(t,"ne")?"ne":this.inCorner(t,"nw")?"nw":this.inCorner(t,"se")?"se":this.inCorner(t,"sw")?"sw":void 0}getMaxExtent(){return this.w>this.h?0:1}}var gt=i("66cb"),yt=i.n(gt),wt=i("8055"),xt=i.n(wt);const bt=xt()(location.protocol+"//"+location.host+"/planarally",{autoConnect:!1});function St(t){bt.io.opts.query=`user=${t.params.creator}&room=${t.params.room}`,bt.connect()}var _t=bt;function Ct(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=16*Math.random()|0,i="x"===t?e:3&e|8;return i.toString(16)})}function kt(t,e){return t.toLowerCase()<e.toLowerCase()?-1:1}function Pt(t,e){const i=[[],[]];return t.forEach(t=>e(t)?i[1].push(t):i[0].push(t)),i}function Lt(t,e,i,s){const o=.2*Number(t.font.split("px")[0]),n=t.measureText(e).width;return Math.min(i/n,s/o)}function Ot(t){const e=zs.$children[0].$refs.activeComponent;return e.$refs[t]}class Mt{constructor(t,e){this.children=[],this.nPrimitives=t,this.bbox=e}}class $t extends Mt{constructor(t,e,i){super(e,i),this.firstPrimOffset=t}}class It extends Mt{constructor(t,e,i){super(0,e.bbox.union(i.bbox)),this.dimension=t,this.children.push(e),this.children.push(i)}}function Dt(t){const e=Vt.zoomFactor,i=Vt.panX,s=Vt.panY;return new pt((t.x+i)*e,(t.y+s)*e)}function zt(t){return Dt(new dt(t,0)).x}function Tt(t){return Dt(new dt(0,t)).y}function At(t){return t*Vt.zoomFactor}function Nt(t){return t/Vt.unitSize*Vt.gridSize}function Bt(t){return At(Nt(t))}function Rt(t){const e=Vt.zoomFactor,i=Vt.panX,s=Vt.panY;return t instanceof pt?new dt(t.x/e-i,t.y/e-s):new mt(Rt(t.origin),t.direction.multiply(1/e),t.tMax)}function Ut(t){return Rt(new pt(t,0)).x}function Et(t){return Rt(new pt(0,t)).y}function Ft(t){return t/Vt.zoomFactor}class Ht{constructor(t){if(this.totalNodes=0,this.buildData=[],this.orderedPrims=[],this.nodes=[],this.offset=0,this.shapes=t,0===this.shapes.length)return this.root=null,void(this.nodes=[]);for(let e=0;e<t.length;e++){const i=te.UUIDMap.get(t[e]);this.buildData.push({index:e,bbox:i.getBoundingBox(),center:new vt(i.center(),0,0)})}this.root=this.recursiveBuild(0,t.length),this.compact()}draw(){const t=te.getLayer("draw").ctx;for(const e of this.nodes){const i=e.bbox;t.strokeRect(zt(i.topLeft.x),Tt(i.topLeft.y),At(i.w),At(i.h))}}recursiveBuild(t,e){this.totalNodes++;let i=this.buildData[t].bbox;for(let o=t+1;o<e;o++)i=i.union(this.buildData[o].bbox);const s=e-t;if(1===s)return this.createLeaf(t,e,s,i);{let o=this.buildData[t].center;for(let i=t;i<e;i++)o=o.union(this.buildData[i].center);const n=o.getMaxExtent();if(o.botRight.get(n)===o.topLeft.get(n))return this.createLeaf(t,e,s,i);const a=.5*(o.topLeft.get(n)+o.botRight.get(n)),r=Pt(this.buildData.slice(t,e),t=>t.center.center().get(n)<a),l=[].concat.apply([],r);0!==r[0].length&&0!==r[1].length||console.log("EMPTY"),this.buildData.splice(t,l.length,...l);const c=r[0].length+t;return new It(n,this.recursiveBuild(t,c),this.recursiveBuild(c,e))}}intersect(t,e){if(0===this.nodes.length)return{hit:!1,intersect:t.get(0),tMin:0,tMax:t.tMax};void 0===e&&(e=!1);let i=!1,s=0,o=t.tMax,n=0,a=0;const r=[],l=t.direction.inverse(),c=[l.x<0,l.y<0];while(1){const u=this.nodes[a],h=u.bbox.intersectP(t,l,c);if(h.hit)if(u.nPrimitives>0){if(i=!0,s=t.tMax=h.min,o=h.max,0===n||e)break;a=r[--n]}else c[u.dimension]?(r[n++]=a+1,a=u.secondChildOffset):(r[n++]=u.secondChildOffset,a++);else{if(0===n)break;a=r[--n]}}return{hit:i,intersect:t.get(s),tMin:s,tMax:o}}compact(){this.offset=0,null!==this.root&&this.flatten(this.root)}flatten(t){const e=this.offset,i=this.offset++;if(0===t.nPrimitives){this.flatten(t.children[0]);const i=this.flatten(t.children[1]);this.nodes[e]={bbox:t.bbox,dimension:t.dimension,nPrimitives:0,secondChildOffset:i}}else this.nodes[e]={bbox:t.bbox,primitivesOffset:t.firstPrimOffset,nPrimitives:t.nPrimitives};return i}createLeaf(t,e,i,s){const o=this.orderedPrims.length;for(let n=t;n<e;n++)this.orderedPrims.push(this.shapes[this.buildData[n].index]);return new $t(o,i,s)}}var Gt=Ht;function Wt(){}let jt=class extends z["d"]{constructor(){super(...arguments),this.layers=[],this.selectedLayerIndex=-1,this.boardInitialized=!1,this.locations=[],this.assets={},this.notes=[],this.IS_DM=!1,this.gridSize=50,this.username="",this.roomName="",this.roomCreator="",this.invitationCode="",this.gridColour="rgba(0, 0, 0, 1)",this.fowColour="rgba(0, 0, 0, 1)",this.rulerColour="rgba(255, 0, 0, 1)",this.panX=0,this.panY=0,this.zoomFactor=1,this.unitSize=5,this.useGrid=!0,this.fullFOW=!1,this.fowOpacity=.3,this.fowLOS=!1,this.locationName="",this.visionSources=[],this.visionBlockers=[],this.annotations=[],this.movementblockers=[],this.ownedtokens=[],this.BV=new Gt([])}get selectedLayer(){return this.layers[this.selectedLayerIndex]}setBoardInitialized(t){this.boardInitialized=t}setDM(t){this.IS_DM=t}setUsername(t){this.username=t}setRoomName(t){this.roomName=t}setRoomCreator(t){this.roomCreator=t}setInvitationCode(t){this.invitationCode=t}addLayer(t){this.layers.push(t),-1===this.selectedLayerIndex&&(this.selectedLayerIndex=this.layers.indexOf(t))}selectLayer(t,e){const i=this.layers.indexOf(t);i>=0&&(this.selectedLayerIndex=i),e&&_t.emit("Client.ActiveLayer.Set",t)}newNote(t,e){this.notes.push(t),e&&_t.emit("Note.New",t)}setAssets(t){this.assets=t}setLocations(t){this.locations=t}resetLayerInfo(){this.layers=[],this.selectedLayerIndex=-1}recalculateBV(){this.boardInitialized&&(this.BV=new Gt(this.visionBlockers))}updateZoom(t,e){if(t===this.zoomFactor)return;t<.1&&(t=.1),t>5&&(t=5);const i=Dt(e);this.zoomFactor=t;const s=Rt(i),o=s.subtract(e);this.panX+=o.x,this.panY+=o.y,te.invalidate(),Wt()}setGridColour(t,e){this.gridColour=t,te.getGridLayer().drawGrid(),e&&_t.emit("Client.Options.Set",{gridColour:t})}setFOWColour(t,e){this.fowColour=t,te.invalidate(),e&&_t.emit("Client.Options.Set",{fowColour:t})}setRulerColour(t,e){this.rulerColour=t,e&&_t.emit("Client.Options.Set",{rulerColour:t})}setPanX(t){this.panX=t}setPanY(t){this.panY=t}setZoomFactor(t){this.zoomFactor=t}increasePanX(t){this.panX+=t}increasePanY(t){this.panY+=t}setUnitSize(t,e){this.unitSize!==t&&(this.unitSize=t,void 0!==te.getGridLayer()&&te.getGridLayer().drawGrid(),e&&_t.emit("Location.Options.Set",{unit_size:t}))}setUseGrid(t,e){if(this.useGrid!==t){this.useGrid=t;const i=te.getGridLayer();i.canvas.style.display=t?"block":"none",e&&_t.emit("Location.Options.Set",{use_grid:t})}}setGridSize(t,e){if(this.gridSize!==t&&t>0){this.gridSize=t;const i=te.getGridLayer();void 0!==i&&i.drawGrid(),e&&_t.emit("Gridsize.Set",t)}}setFullFOW(t,e){this.fullFOW!==t&&(this.fullFOW=t,te.invalidateLight(),e&&_t.emit("Location.Options.Set",{full_fow:t}))}setFOWOpacity(t,e){this.fowOpacity=t,te.invalidateLight(),e&&_t.emit("Location.Options.Set",{fow_opacity:t})}setLineOfSight(t,e){this.fowLOS!==t&&(this.fowLOS=t,te.invalidate(),e&&_t.emit("Location.Options.Set",{fow_los:t}))}setLocationName(t){this.locationName=t}updateNote(t,e){const i=this.notes.find(e=>e.uuid===t.uuid);void 0!==i&&(i.title=t.title,i.text=t.text,e&&_t.emit("Note.Update",i))}removeNote(t,e){this.notes=this.notes.filter(e=>e.uuid!==t.uuid),e&&_t.emit("Note.Remove",t.uuid)}clear(){this.context.getters.visionSources=[],this.context.getters.visionBlockers=[],this.context.getters.ownedtokens=[],this.context.getters.annotations=[],this.context.getters.movementblockers=[],this.context.commit("recalculateBV")}};m["a"]([z["c"]],jt.prototype,"setBoardInitialized",null),m["a"]([z["c"]],jt.prototype,"setDM",null),m["a"]([z["c"]],jt.prototype,"setUsername",null),m["a"]([z["c"]],jt.prototype,"setRoomName",null),m["a"]([z["c"]],jt.prototype,"setRoomCreator",null),m["a"]([z["c"]],jt.prototype,"setInvitationCode",null),m["a"]([z["c"]],jt.prototype,"addLayer",null),m["a"]([z["c"]],jt.prototype,"selectLayer",null),m["a"]([z["c"]],jt.prototype,"newNote",null),m["a"]([z["c"]],jt.prototype,"setAssets",null),m["a"]([z["c"]],jt.prototype,"setLocations",null),m["a"]([z["c"]],jt.prototype,"resetLayerInfo",null),m["a"]([z["c"]],jt.prototype,"recalculateBV",null),m["a"]([z["c"]],jt.prototype,"updateZoom",null),m["a"]([z["c"]],jt.prototype,"setGridColour",null),m["a"]([z["c"]],jt.prototype,"setFOWColour",null),m["a"]([z["c"]],jt.prototype,"setRulerColour",null),m["a"]([z["c"]],jt.prototype,"setPanX",null),m["a"]([z["c"]],jt.prototype,"setPanY",null),m["a"]([z["c"]],jt.prototype,"setZoomFactor",null),m["a"]([z["c"]],jt.prototype,"increasePanX",null),m["a"]([z["c"]],jt.prototype,"increasePanY",null),m["a"]([z["c"]],jt.prototype,"setUnitSize",null),m["a"]([z["c"]],jt.prototype,"setUseGrid",null),m["a"]([z["c"]],jt.prototype,"setGridSize",null),m["a"]([z["c"]],jt.prototype,"setFullFOW",null),m["a"]([z["c"]],jt.prototype,"setFOWOpacity",null),m["a"]([z["c"]],jt.prototype,"setLineOfSight",null),m["a"]([z["c"]],jt.prototype,"setLocationName",null),m["a"]([z["c"]],jt.prototype,"updateNote",null),m["a"]([z["c"]],jt.prototype,"removeNote",null),m["a"]([z["a"]],jt.prototype,"clear",null),jt=m["a"]([Object(z["b"])({dynamic:!0,store:C,name:"game",namespaced:!0})],jt);var Vt=Object(z["e"])(jt);const Yt=t=>{const e=[];for(const i of t)e.push({uuid:i.uuid,visionSource:i.vision_source,visible:i.visible,name:i.name,value:i.value,dim:i.dim,colour:i.colour});return e},Xt=t=>{const e=[];for(const i of t)e.push({uuid:i.uuid,vision_source:i.visionSource,visible:i.visible,name:i.name,value:i.value,dim:i.dim,colour:i.colour});return e};class qt{constructor(t,e,i,s){this.fillColour="#000",this.strokeColour="rgba(0,0,0,0)",this.name="Unknown shape",this.trackers=[],this.auras=[],this.owners=[],this.visionObstruction=!1,this.movementObstruction=!1,this.isToken=!1,this.showHighlight=!1,this.annotation="",this.globalCompositeOperation="source-over",this.options=new Map,this.refPoint=t,this.uuid=s||Ct(),void 0!==e&&(this.fillColour=e),void 0!==i&&(this.strokeColour=i)}visibleInCanvas(t){return!1}invalidate(t){const e=te.getLayer(this.layer);e&&e.invalidate(t)}checkVisionSources(){const t=this,e=Vt.visionBlockers.indexOf(this.uuid);let i=!1;this.visionObstruction&&-1===e?(Vt.visionBlockers.push(this.uuid),i=!0):!this.visionObstruction&&e>=0&&(Vt.visionBlockers.splice(e,1),i=!0),i&&Vt.recalculateBV(),this.auras.forEach(e=>{const i=Vt.visionSources,s=i.findIndex(t=>t.aura===e.uuid);e.visionSource&&-1===s?i.push({shape:t.uuid,aura:e.uuid}):!e.visionSource&&s>=0&&i.splice(s,1)});for(let s=Vt.visionSources.length-1;s>=0;s--){const e=Vt.visionSources[s];e.shape===t.uuid&&(t.auras.some(t=>t.uuid===e.aura&&t.visionSource)||Vt.visionSources.splice(s,1))}}setMovementBlock(t){this.movementObstruction=t||!1;const e=Vt.movementblockers.indexOf(this.uuid);this.movementObstruction&&-1===e?Vt.movementblockers.push(this.uuid):!this.movementObstruction&&e>=0&&Vt.movementblockers.splice(e,1)}setIsToken(t){if(this.isToken=t,this.ownedBy()){const t=Vt.ownedtokens.indexOf(this.uuid);this.isToken&&-1===t?Vt.ownedtokens.push(this.uuid):!this.isToken&&t>=0&&Vt.ownedtokens.splice(t,1)}}ownedBy(t){return void 0===t&&(t=Vt.username),Vt.IS_DM||this.owners.includes(t)}getBaseDict(){return{type_:this.type,uuid:this.uuid,x:this.refPoint.x,y:this.refPoint.y,layer:this.layer,draw_operator:this.globalCompositeOperation,movement_obstruction:this.movementObstruction,vision_obstruction:this.visionObstruction,auras:Xt(this.auras),trackers:this.trackers,owners:this.owners,fill_colour:this.fillColour,stroke_colour:this.strokeColour,name:this.name,annotation:this.annotation,is_token:this.isToken,options:JSON.stringify([...this.options])}}fromDict(t){this.layer=t.layer,this.globalCompositeOperation=t.draw_operator,this.movementObstruction=t.movement_obstruction,this.visionObstruction=t.vision_obstruction,this.auras=Yt(t.auras),this.trackers=t.trackers,this.owners=t.owners,this.isToken=t.is_token,t.annotation&&(this.annotation=t.annotation),t.name&&(this.name=t.name),t.options&&(this.options=new Map(JSON.parse(t.options)))}draw(t){if(void 0!==this.globalCompositeOperation?t.globalCompositeOperation=this.globalCompositeOperation:t.globalCompositeOperation="source-over",this.showHighlight){const e=this.getBoundingBox();t.strokeStyle="red",t.strokeRect(zt(e.topLeft.x)-5,Tt(e.topLeft.y)-5,At(e.w)+10,At(e.h)+10)}}drawAuras(t){for(const i of this.auras){if(0===i.value&&0===i.dim)return;t.beginPath();const s=Dt(this.center()),o=Bt(i.value+i.dim);if(0===i.dim)t.fillStyle=i.colour;else{const e=t.createRadialGradient(s.x,s.y,Bt(i.value),s.x,s.y,Bt(i.value+i.dim)),o=yt()(i.colour);t.fillStyle=e,e.addColorStop(0,i.colour),e.addColorStop(1,o.setAlpha(0).toRgbString())}if(i.visionSource&&void 0!==i.lastPath)try{t.fill(i.lastPath)}catch(e){t.arc(s.x,s.y,o,0,2*Math.PI),t.fill(),console.warn(e)}else t.arc(s.x,s.y,o,0,2*Math.PI),t.fill()}}getInitiativeRepr(){return{uuid:this.uuid,visible:!Vt.IS_DM,group:!1,source:this.name,has_img:!1,effects:[],index:1/0}}moveLayer(t,e){const i=te.getLayer(this.layer),s=te.getLayer(t);void 0!==i&&void 0!==s&&(this.layer=t,i.shapes.splice(i.shapes.indexOf(this),1),s.shapes.push(this),i.invalidate(!0),s.invalidate(!1),e&&_t.emit("Shape.Layer.Change",{uuid:this.uuid,layer:t}))}}function Jt(t,e,i){void 0===i&&(i=[]);const s=e.getBoundingBox(),o=s.offset(t);let n=!1;for(const a of Vt.movementblockers){if(i.includes(a))continue;const e=te.UUIDMap.get(a),r=e.getBoundingBox();let l=r.intersectsWithInner(o);if(!l){const e=mt.fromPoints(s.topLeft.add(t.normalize()),o.topLeft),i=e.direction.inverse(),n=[i.x<0,i.y<0];l=r.intersectP(e,i,n).hit}if(l){const e=r.center(),o=s.center(),l=o.subtract(e),c=new ft(1,0),u=new ft(0,1);let h=l.dot(c),d=l.dot(u);h>r.w/2&&(h=r.w/2),h<-r.w/2&&(h=-r.w/2),d>r.h/2&&(d=r.h/2),d<-r.h/2&&(d=-r.h/2);const p=e.add(c.multiply(h)).add(u.multiply(d));p.x===s.topLeft.x||p.x===s.topRight.x?t=new ft(0,t.y):p.y===s.topLeft.y||p.y===s.botLeft.y?t=new ft(t.x,0):p.x<s.topLeft.x?t=new ft(p.x-s.topLeft.x,t.y):p.x>s.topRight.x?t=new ft(p.x-s.topRight.x,t.y):p.y<s.topLeft.y?t=new ft(t.x,p.y-s.topLeft.y):p.y>s.botLeft.y&&(t=new ft(t.x,p.y-s.botLeft.y)),n=!0,i.push(a);break}}return n&&(t=Jt(t,e,i)),t}class Zt extends qt{constructor(t,e,i,s,o,n){super(t,s,o,n),this.w=e,this.h=i}getBaseDict(){return Object.assign(super.getBaseDict(),{width:this.w,height:this.h})}getBoundingBox(){return new vt(this.refPoint,this.w,this.h)}contains(t){return this.refPoint.x<=t.x&&this.refPoint.x+this.w>=t.x&&this.refPoint.y<=t.y&&this.refPoint.y+this.h>=t.y}inCorner(t,e){switch(e){case"ne":return this.refPoint.x+this.w-3<=t.x&&t.x<=this.refPoint.x+this.w+3&&this.refPoint.y-3<=t.y&&t.y<=this.refPoint.y+3;case"nw":return this.refPoint.x-3<=t.x&&t.x<=this.refPoint.x+3&&this.refPoint.y-3<=t.y&&t.y<=this.refPoint.y+3;case"sw":return this.refPoint.x-3<=t.x&&t.x<=this.refPoint.x+3&&this.refPoint.y+this.h-3<=t.y&&t.y<=this.refPoint.y+this.h+3;case"se":return this.refPoint.x+this.w-3<=t.x&&t.x<=this.refPoint.x+this.w+3&&this.refPoint.y+this.h-3<=t.y&&t.y<=this.refPoint.y+this.h+3;default:return!1}}getCorner(t){return this.inCorner(t,"ne")?"ne":this.inCorner(t,"nw")?"nw":this.inCorner(t,"se")?"se":this.inCorner(t,"sw")?"sw":void 0}center(t){if(void 0===t)return this.refPoint.add(new ft(this.w/2,this.h/2));this.refPoint.x=t.x-this.w/2,this.refPoint.y=t.y-this.h/2}visibleInCanvas(t){if(super.visibleInCanvas(t))return!0;const e=!(zt(this.refPoint.x)>t.width||Tt(this.refPoint.y)>t.height||zt(this.refPoint.x+this.w)<0||Tt(this.refPoint.y+this.h)<0);return!!e}snapToGrid(){const t=Vt.gridSize,e=this.center(),i=e.x,s=e.y;let o,n;o=this.w/t%2===0?Math.round(i/t)*t-this.w/2:(Math.round((i+t/2)/t)-.5)*t-this.w/2,n=this.h/t%2===0?Math.round(s/t)*t-this.h/2:(Math.round((s+t/2)/t)-.5)*t-this.h/2;const a=Jt(new ft(o-this.refPoint.x,n-this.refPoint.y),this);this.refPoint=this.refPoint.add(a),this.invalidate(!1)}resizeToGrid(){const t=Vt.gridSize;this.refPoint.x=Math.round(this.refPoint.x/t)*t,this.refPoint.y=Math.round(this.refPoint.y/t)*t,this.w=Math.max(Math.round(this.w/t)*t,t),this.h=Math.max(Math.round(this.h/t)*t,t),this.invalidate(!1)}resize(t,e){const i=Vt.zoomFactor;"nw"===t?(this.w=zt(this.refPoint.x)+this.w*i-e.x,this.h=Tt(this.refPoint.y)+this.h*i-e.y,this.refPoint=Rt(e)):"ne"===t?(this.w=e.x-zt(this.refPoint.x),this.h=Tt(this.refPoint.y)+this.h*i-e.y,this.refPoint.y=Et(e.y)):"se"===t?(this.w=e.x-zt(this.refPoint.x),this.h=e.y-Tt(this.refPoint.y)):"sw"===t&&(this.w=zt(this.refPoint.x)+this.w*i-e.x,this.h=e.y-Tt(this.refPoint.y),this.refPoint.x=Ut(e.x)),this.w/=i,this.h/=i,this.w<0&&(this.refPoint.x+=this.w,this.w=Math.abs(this.w)),this.h<0&&(this.refPoint.y+=this.h,this.h=Math.abs(this.h))}}class Kt extends Zt{constructor(t,e,i,s,o){super(e,i,s),this.type="assetrect",this.src="",void 0!==o&&(this.uuid=o),this.img=t}asDict(){return Object.assign(this.getBaseDict(),{src:this.src})}fromDict(t){super.fromDict(t),this.src=t.src}draw(t){super.draw(t);try{t.drawImage(this.img,zt(this.refPoint.x),Tt(this.refPoint.y),At(this.w),At(this.h))}catch(e){console.warn(`Shape ${this.uuid} could not load the image ${this.src}`)}}getInitiativeRepr(){return{uuid:this.uuid,visible:!Vt.IS_DM,group:!1,source:this.src,has_img:!0,effects:[],index:1/0}}}class Qt{constructor(){this.layers=[],this.width=window.innerWidth,this.height=window.innerHeight,this.UUIDMap=new Map,this.interval=30;const t=this;setInterval(()=>{for(let e=t.layers.length-1;e>=0;e--)t.layers[e].draw()},this.interval)}setWidth(t){this.width=t;for(const e of this.layers)e.canvas.width=t,e.width=t}setHeight(t){this.height=t;for(const e of this.layers)e.canvas.height=t,e.height=t}addLayer(t){this.layers.push(t),(Vt.IS_DM||t.playerEditable)&&t.selectable&&Vt.addLayer(t.name)}hasLayer(t){return this.layers.some(e=>e.name===t)}getLayer(t){t=void 0===t?Vt.selectedLayer:t;for(const e of this.layers)if(e.name===t)return e}selectLayer(t,e=!0){let i=!1;for(const s of this.layers)s.selectable&&(i&&"fow"!==s.name?s.ctx.globalAlpha=.3:s.ctx.globalAlpha=1,t===s.name&&(Vt.selectLayer(t,e),i=!0),s.clearSelection(),s.invalidate(!0))}getGridLayer(){return this.getLayer("grid")}hasSelection(){const t=this.getSelection();return void 0!==t&&t.length>0}getSelection(){const t=this.getLayer();if(void 0!==t)return t.selection}invalidate(){for(let t=this.layers.length-1;t>=0;t--)this.layers[t].invalidate(!0)}invalidateLight(){for(let t=this.layers.length-1;t>=0;t--)this.layers[t].isVisionLayer&&this.layers[t].invalidate(!0)}dropAsset(t){const e=this.getLayer();if(void 0===e||null===t||null===t.dataTransfer)return;const i=document.createElement("img");i.src=t.dataTransfer.getData("text/plain");const s=new Kt(i,new dt(Ut(t.clientX),Et(t.clientY)),Ft(i.width),Ft(i.height));if(s.src=new URL(i.src).pathname,Vt.useGrid){const t=Vt.gridSize;s.refPoint.x=Math.round(s.refPoint.x/t)*t,s.refPoint.y=Math.round(s.refPoint.y/t)*t,s.w=Math.max(Math.round(s.w/t)*t,t),s.h=Math.max(Math.round(s.h/t)*t,t)}e.addShape(s,!0)}}var te=new Qt,ee=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{visible:t.visible,mask:!1},on:{close:function(e){t.visible=!1}},scopedSlots:t._u([{key:"header",fn:function(e){return i("div",{staticClass:"modal-header",attrs:{draggable:"true"},on:{dragstart:e.dragStart,dragend:e.dragEnd}},[i("div",[t._v("Initiative")]),i("div",{staticClass:"header-close",on:{click:function(e){t.visible=!1}}},[i("i",{staticClass:"far fa-window-close"})])])}}])},[i("div",{staticClass:"modal-body"},[i("draggable",{attrs:{id:"initiative-list",options:{setData:t.fakeSetData,disabled:!t.$store.state.game.IS_DM}},on:{change:t.updateOrder},model:{value:t.data,callback:function(e){t.data=e},expression:"data"}},[t._l(t.data,function(e){return[i("div",{key:e.uuid,staticStyle:{display:"flex","flex-direction":"column","align-items":"flex-end"}},[i("div",{staticClass:"initiative-actor",class:{"initiative-selected":t.currentActor===e.uuid},style:{cursor:t.$store.state.game.IS_DM&&"move"},on:{mouseenter:function(i){t.toggleHighlight(e,!0)},mouseleave:function(i){t.toggleHighlight(e,!1)}}},[e.has_img?[i("img",{attrs:{src:e.source,width:"30px",height:"30px"}})]:[i("span",{staticStyle:{width:"auto"}},[t._v(t._s(e.source))])],i("input",{directives:[{name:"model",rawName:"v-model.lazy.number",value:e.initiative,expression:"actor.initiative",modifiers:{lazy:!0,number:!0}}],class:{notAllowed:!t.owns(e)},attrs:{type:"text",placeholder:"value",disabled:!t.owns(e)},domProps:{value:e.initiative},on:{change:[function(i){t.$set(e,"initiative",t._n(i.target.value))},function(i){t.syncInitiative(e)}],blur:function(e){t.$forceUpdate()}}}),i("div",{staticClass:"initiative-effects-icon",class:{notAllowed:!t.owns(e)},staticStyle:{opacity:"0.6"},on:{click:function(i){t.createEffect(e,t.getDefaultEffect(),!0)}}},[i("i",{staticClass:"fas fa-stopwatch"}),e.effects?[t._v(t._s(e.effects.length))]:[t._v("0")]],2),i("div",{class:{notAllowed:!t.owns(e)},style:{opacity:e.visible?"1.0":"0.3"},on:{click:function(i){t.toggleOption(e,"visible")}}},[i("i",{staticClass:"fas fa-eye"})]),i("div",{class:{notAllowed:!t.owns(e)},style:{opacity:e.group?"1.0":"0.3"},on:{click:function(i){t.toggleOption(e,"group")}}},[i("i",{staticClass:"fas fa-users"})]),i("div",{class:{notAllowed:!t.owns(e)},style:{opacity:t.owns(e)?"1.0":"0.3"},on:{click:function(i){t.removeInitiative(e.uuid,!0,!0)}}},[i("i",{staticClass:"fas fa-trash-alt"})])],2),e.effects?i("div",{staticClass:"initiative-effect"},t._l(e.effects,function(s){return i("div",{key:s.uuid},[i("input",{directives:[{name:"model",rawName:"v-model",value:s.name,expression:"effect.name"}],attrs:{type:"text",size:s.name.length||1},domProps:{value:s.name},on:{change:function(i){t.updateEffect(e.uuid,s,!0)},input:function(e){e.target.composing||t.$set(s,"name",e.target.value)}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:s.turns,expression:"effect.turns"}],attrs:{type:"text",size:s.turns.toString().length||1},domProps:{value:s.turns},on:{change:function(i){t.updateEffect(e.uuid,s,!0)},input:function(e){e.target.composing||t.$set(s,"turns",e.target.value)}}})])})):t._e()])]})],2),i("div",{attrs:{id:"initiative-bar"}},[i("div",{attrs:{id:"initiative-round"}},[t._v("Round "+t._s(t.roundCounter))]),i("div",{staticStyle:{display:"flex"}}),i("div",{staticClass:"initiative-bar-button",class:{notAllowed:!t.$store.state.game.IS_DM},on:{click:function(e){t.setRound(0,!0),t.setTurn(t.data[0].uuid,!0)}}},[i("i",{staticClass:"fas fa-sync-alt"})]),i("div",{staticClass:"initiative-bar-button",class:{notAllowed:!t.$store.state.game.IS_DM},on:{click:t.nextTurn}},[i("i",{staticClass:"fas fa-chevron-right"})])])],1)])},ie=[],se=i("1516"),oe=i.n(se);s["default"].component("draggable",oe.a);var ne=s["default"].component("initiative-dialog",{data:()=>({visible:!1,data:[],currentActor:null,roundCounter:0}),components:{modal:tt,draggable:oe.a},methods:{clear(){this.data=[],this.currentActor=null},getActor(t){return this.data.find(e=>e.uuid===t)},contains(t){return this.data.some(e=>e.uuid===t)},owns(t){if(this.$store.state.game.IS_DM)return!0;const e=te.UUIDMap.get(t.uuid);return void 0!==e&&e.owners.includes(this.$store.state.game.username)},getDefaultEffect(){return{uuid:Ct(),name:"New Effect",turns:10}},fakeSetData(t){t.setData("Hack","")},syncInitiative(t){_t.emit("Initiative.Update",t)},addInitiative(t){const e=this.data.findIndex(e=>e.uuid===t.uuid);e>=0||(void 0===t.initiative&&(t.initiative=0),this.syncInitiative(t))},removeInitiative(t){const e=this.data.findIndex(e=>e.uuid===t);if(e<0||this.data[e].group)return;this.syncInitiative({uuid:t});const i=te.UUIDMap.get(t);void 0!==i&&i.showHighlight&&(i.showHighlight=!1,te.getLayer(i.layer).invalidate(!0))},updateOrder(){this.$store.state.game.IS_DM&&_t.emit("Initiative.Set",this.data.map(t=>t.uuid))},setTurn(t,e){if(!this.$store.state.game.IS_DM&&e)return;this.currentActor=t;const i=this.data.find(e=>e.uuid===t);if(void 0!==i){if(i.effects)for(let t=i.effects.length-1;t>=0;t--)i.effects[t].turns<=0?i.effects.splice(t,1):i.effects[t].turns--;e&&_t.emit("Initiative.Turn.Update",t)}},setRound(t,e){!this.$store.state.game.IS_DM&&e||(this.roundCounter=t,e&&_t.emit("Initiative.Round.Update",t))},nextTurn(){if(!this.$store.state.game.IS_DM)return;const t=this.data,e=t[(t.findIndex(t=>t.uuid===this.currentActor)+1)%t.length];this.data[0].uuid===e.uuid&&this.setRound(this.roundCounter+1,!0),this.setTurn(e.uuid,!0)},toggleHighlight(t,e){const i=te.UUIDMap.get(t.uuid);void 0!==i&&(i.showHighlight=e,te.getLayer(i.layer).invalidate(!0))},toggleOption(t,e){this.owns(t)&&(t[e]=!t[e],this.syncInitiative(t))},createEffect(t,e,i){this.owns(t)&&(t.effects.push(e),i&&_t.emit("Initiative.Effect.New",{actor:t.uuid,effect:e}))},syncEffect(t,e){this.owns(t)&&_t.emit("Initiative.Effect.Update",{actor:t.uuid,effect:e})},updateEffect(t,e,i){const s=this.data.find(e=>e.uuid===t);if(void 0===s)return;const o=s.effects.findIndex(t=>t.uuid===e.uuid);void 0!==o&&(s.effects[o]=e,i?this.syncEffect(s,e):this.$forceUpdate())}}}),ae=ne,re=(i("21c7"),Object(a["a"])(ae,ee,ie,!1,null,"942876ae",null));re.options.__file="initiative.vue";var le=re.exports,ce=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"menuContainer"}},[i("div",{ref:"rm",style:{left:t.visible.settings?"200px":"0",top:t.visible.locations?"100px":"0"},attrs:{id:"radialmenu"}},[i("div",{staticClass:"rm-wrapper"},[i("div",{staticClass:"rm-toggler"},[i("ul",{staticClass:"rm-list",class:{"rm-list-dm":t.IS_DM}},[t.IS_DM?i("li",{staticClass:"rm-item",attrs:{id:"rm-locations"},on:{click:function(e){t.visible.locations=!t.visible.locations}}},[t._m(0)]):t._e(),i("li",{staticClass:"rm-item",attrs:{id:"rm-settings"},on:{click:function(e){t.visible.settings=!t.visible.settings}}},[t._m(1)])])]),t._m(2)])]),i("transition",{attrs:{name:"settings"},on:{enter:function(e){t.$refs.rm.style.transition="left 500ms"}}},[t.visible.settings?i("div",{ref:"settings",attrs:{id:"menu"},on:{click:t.settingsClick}},[i("div",{staticStyle:{width:"200px",height:"90%","overflow-y":"auto","overflow-x":"hidden"}},[t.IS_DM?[i("button",{staticClass:"accordion"},[t._v("Assets")]),i("div",{staticClass:"accordion-panel"},[i("a",{staticClass:"actionButton",attrs:{href:"/assets/",target:"blank"}},[i("i",{staticClass:"fas fa-external-link-alt"})]),i("div",{staticClass:"directory",attrs:{id:"menu-tokens"}},[i("asset-node",{attrs:{asset:t.assets}})],1)]),i("button",{staticClass:"accordion"},[t._v("Notes")]),i("div",{staticClass:"accordion-panel"},[i("div",{staticClass:"accordion-subpanel",attrs:{id:"menu-notes"}},[i("a",{staticClass:"actionButton",on:{click:t.createNote}},[i("i",{staticClass:"far fa-plus-square"})]),t._l(t.notes,function(e){return i("div",{key:e.uuid,staticStyle:{cursor:"pointer"},on:{click:function(i){t.openNote(e)}}},[t._v(t._s(e.title||"[?]"))])}),t.notes.length?t._e():i("div",[t._v("No notes")])],2)]),i("button",{staticClass:"accordion"},[t._v("DM Options")]),i("div",{staticClass:"accordion-panel"},[i("div",{staticClass:"accordion-subpanel"},[i("label",{attrs:{for:"useGridInput"}},[t._v("Use grid:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.useGrid,expression:"useGrid"}],attrs:{id:"useGridInput",type:"checkbox",checked:"checked"},domProps:{checked:Array.isArray(t.useGrid)?t._i(t.useGrid,null)>-1:t.useGrid},on:{change:function(e){var i=t.useGrid,s=e.target,o=!!s.checked;if(Array.isArray(i)){var n=null,a=t._i(i,n);s.checked?a<0&&(t.useGrid=i.concat([n])):a>-1&&(t.useGrid=i.slice(0,a).concat(i.slice(a+1)))}else t.useGrid=o}}}),i("label",{attrs:{for:"useFOWInput"}},[t._v("Fill entire canvas with FOW:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.fullFOW,expression:"fullFOW"}],attrs:{id:"useFOWInput",type:"checkbox"},domProps:{checked:Array.isArray(t.fullFOW)?t._i(t.fullFOW,null)>-1:t.fullFOW},on:{change:function(e){var i=t.fullFOW,s=e.target,o=!!s.checked;if(Array.isArray(i)){var n=null,a=t._i(i,n);s.checked?a<0&&(t.fullFOW=i.concat([n])):a>-1&&(t.fullFOW=i.slice(0,a).concat(i.slice(a+1)))}else t.fullFOW=o}}}),i("label",{attrs:{for:"fowOpacity"}},[t._v("FOW opacity:")]),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.fowOpacity,expression:"fowOpacity",modifiers:{number:!0}}],attrs:{id:"fowOpacity",type:"number",min:"0",max:"1",step:"0.1"},domProps:{value:t.fowOpacity},on:{input:function(e){e.target.composing||(t.fowOpacity=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}}),i("label",{attrs:{for:"fowLOS"}},[t._v("Only show lights in LoS:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.fowLOS,expression:"fowLOS"}],attrs:{id:"fowLOS",type:"checkbox"},domProps:{checked:Array.isArray(t.fowLOS)?t._i(t.fowLOS,null)>-1:t.fowLOS},on:{change:function(e){var i=t.fowLOS,s=e.target,o=!!s.checked;if(Array.isArray(i)){var n=null,a=t._i(i,n);s.checked?a<0&&(t.fowLOS=i.concat([n])):a>-1&&(t.fowLOS=i.slice(0,a).concat(i.slice(a+1)))}else t.fowLOS=o}}}),i("label",{attrs:{for:"unitSizeInput"}},[t._v("Unit Size (in ft.):")]),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.unitSize,expression:"unitSize",modifiers:{number:!0}}],attrs:{id:"unitSizeInput",type:"number"},domProps:{value:t.unitSize},on:{input:function(e){e.target.composing||(t.unitSize=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}}),i("label",{attrs:{for:"gridSizeInput"}},[t._v("Grid Size (in pixels):")]),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.gridSize,expression:"gridSize",modifiers:{number:!0}}],attrs:{id:"gridSizeInput",type:"number",min:"0"},domProps:{value:t.gridSize},on:{input:function(e){e.target.composing||(t.gridSize=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}}),i("label",{attrs:{for:"invitation"}},[t._v("Invitation Code:")]),i("input",{attrs:{id:"invitation",type:"text",readonly:"readonly"},domProps:{value:t.invitationCode}})])])]:t._e(),i("button",{staticClass:"accordion"},[t._v("Client Options")]),i("div",{staticClass:"accordion-panel"},[i("div",{staticClass:"accordion-subpanel"},[i("label",{attrs:{for:"gridColour"}},[t._v("Grid Colour:")]),i("color-picker",{attrs:{id:"gridColour",color:t.gridColour},on:{"update:color":function(e){t.gridColour=e}}}),i("label",{attrs:{for:"fowColour"}},[t._v("FOW Colour:")]),i("color-picker",{attrs:{id:"fowColour",color:t.fowColour},on:{"update:color":function(e){t.fowColour=e}}}),i("label",{attrs:{for:"rulerColour"}},[t._v("Ruler Colour:")]),i("color-picker",{attrs:{id:"rulerColour",color:t.rulerColour},on:{"update:color":function(e){t.rulerColour=e}}})],1)])],2),i("a",{staticClass:"accordion",staticStyle:{"text-decoration":"none",display:"inline-block",position:"absolute",bottom:"0"},attrs:{href:"/rooms"}},[t._v("Exit")])]):t._e()]),i("transition",{attrs:{name:"locations"},on:{enter:function(e){t.$refs.rm.style.transition="top 500ms"}}},[t.IS_DM&&t.visible.locations?i("div",{attrs:{id:"locations-menu"}},[i("div",[t._l(t.locations,function(e){return i("div",{key:e,on:{click:function(i){t.changeLocation(e)}}},[t._v(t._s(e))])}),i("div",{on:{click:t.createLocation}},[i("i",{staticClass:"fas fa-plus"})])],2)]):t._e()]),i("img",{attrs:{id:"dragImage"}})],1)},ue=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{attrs:{href:"#"}},[i("i",{staticClass:"far fa-compass"})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{attrs:{href:"#"}},[i("i",{staticClass:"fas fa-cog"})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"rm-topper"},[i("i",{staticClass:"icon-share-alt"})])}],he=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer",on:{click:function(e){return e.target!==e.currentTarget?null:t.open(e)}}},[i("div",{staticClass:"current-color",style:t.transparent?"background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwH+YwCGIasIUwhT25BVBADtzYNYrHvv4gAAAABJRU5ErkJggg==)":"background-color:"+t.color,on:{click:function(e){return e.target!==e.currentTarget?null:t.open(e)}}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"display"}],staticClass:"mask",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePicker(e)}}}),i("chrome-picker",{directives:[{name:"show",rawName:"v-show",value:t.display,expression:"display"}],ref:"chromePicker",style:{position:"fixed",left:t.left+"px",top:t.top+"px","z-index":9999},attrs:{value:t.color,tabindex:"-1"},on:{input:t.updateColor}})],1)},de=[],pe=i("c345"),fe=s["default"].component("colorpicker",{components:{"chrome-picker":pe["Chrome"]},props:["color"],data:()=>({display:!1,left:0,top:0,transparent:!1}),mounted(){this.transparent=0===this.$refs.chromePicker.val.rgba.a,this.setPosition()},methods:{open(){this.display||(this.setPosition(),this.display=!0,this.$nextTick(()=>this.$children[0].$el.focus()))},updateColor(t){this.transparent=0===t.rgba.a;const e=yt()(t.rgba).toRgbString();this.$emit("update:color",e),this.$emit("input",e)},closePicker(){this.display=!1,this.$emit("change",this.color)},setPosition(){const t=this.$el.getBoundingClientRect();t.right+224>window.innerWidth?this.left=t.left-224:this.left=t.right,t.bottom+242>window.innerHeight?this.top=t.top-242:this.top=t.bottom}}}),me=fe,ve=(i("0f76"),Object(a["a"])(me,he,de,!1,null,"2c377313",null));ve.options.__file="colorpicker.vue";var ge=ve.exports,ye=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",[t._l(t.folders,function(e){return i("li",{key:e,staticClass:"folder",on:{click:function(e){return e.stopPropagation(),t.toggle(e)}}},[t._v("\n        "+t._s(e)+"\n        "),i("asset-node",{attrs:{asset:t.asset[e]}})],1)}),t._l(t.files,function(e){return i("li",{key:e.name,staticClass:"file draggable token",attrs:{draggable:"true"},on:{mouseover:function(i){t.showImage=e.hash},mouseout:function(e){t.showImage=null},dragstart:function(i){t.dragStart(i,"/static/assets/"+e.hash)}}},[t._v("\n        "+t._s(e.name)+"\n        "),t.showImage==e.hash?i("div",{staticClass:"preview"},[i("img",{staticClass:"asset-preview-image",attrs:{src:"/static/assets/"+e.hash}})]):t._e()])})],2)},we=[],xe=s["default"].component("asset-node",{props:["asset","open"],data:()=>({showImage:null}),computed:{folders(){return Object.keys(this.asset).filter(t=>!["__files"].includes(t)).sort(kt)},files(){return this.asset.__files?this.asset.__files.concat().sort((t,e)=>t.name.toLowerCase()>e.name.toLowerCase()?1:-1):[]}},methods:{toggle(t){for(let e=0;e<t.target.children.length;e++){const i=t.target.children[e];i.style.display=""===i.style.display?"block":""}},dragStart(t,e){if(null===t||null===t.dataTransfer)return;const i=t.target.querySelector(".preview");t.dataTransfer.setDragImage(i,0,0),t.dataTransfer.setData("text/plain",e)}}}),be=xe,Se=(i("7fc2"),Object(a["a"])(be,ye,we,!1,null,null,null));Se.options.__file="asset_node.vue";var _e=Se.exports,Ce=s["default"].component("menu-bar",{components:{"color-picker":ge,"asset-node":_e},data:()=>({visible:{settings:!1,locations:!1}}),computed:Object.assign({},Object(_["c"])("game",["invitationCode","IS_DM","locations","assets","notes"]),{useGrid:{get(){return this.$store.state.game.useGrid},set(t){this.$store.commit("setUseGrid",{useGrid:t,sync:!0})}},fullFOW:{get(){return this.$store.state.game.fullFOW},set(t){this.$store.commit("setFullFOW",{fullFOW:t,sync:!0})}},fowOpacity:{get(){return this.$store.state.game.fowOpacity},set(t){"number"===typeof t&&this.$store.commit("setFOWOpacity",{fowOpacity:t,sync:!0})}},fowLOS:{get(){return this.$store.state.game.fowLOS},set(t){this.$store.commit("setLineOfSight",{fowLOS:t,sync:!0})}},unitSize:{get(){return this.$store.state.game.unitSize},set(t){"number"===typeof t&&this.$store.commit("setUnitSize",{unitSize:t,sync:!0})}},gridSize:{get(){return this.$store.state.game.gridSize},set(t){"number"===typeof t&&this.$store.commit("setGridSize",{gridSize:t,sync:!0})}},gridColour:{get(){return this.$store.state.game.gridColour},set(t){this.$store.commit("setGridColour",{colour:t,sync:!0})}},fowColour:{get(){return this.$store.state.game.fowColour},set(t){this.$store.commit("setFOWColour",{colour:t,sync:!0})}},rulerColour:{get(){return this.$store.state.game.rulerColour},set(t){this.$store.commit("setRulerColour",{colour:t,sync:!0})}}}),methods:{settingsClick(t){if(t.target.classList.contains("accordion")){t.target.classList.toggle("accordion-active");const e=t.target.nextElementSibling;e.style.display=""===e.style.display?"block":""}},changeLocation(t){_t.emit("Location.Change",t)},createLocation(){Ms.$refs.prompt.prompt("New location name:","Create new location").then(t=>{_t.emit("Location.New",t)},()=>{})},createNote(){const t={title:"New note",text:"",uuid:Ct()};this.$store.commit("newNote",{note:t,sync:!0}),this.openNote(t)},openNote(t){Ms.$refs.note.open(t)}}}),ke=Ce,Pe=(i("fe78"),Object(a["a"])(ke,ce,ue,!1,null,"4bb01ba9",null));Pe.options.__file="menu.vue";var Le=Pe.exports,Oe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return null!==t.note?i("modal",{attrs:{visible:t.visible,mask:!1},on:{close:function(e){t.visible=!1}},scopedSlots:t._u([{key:"header",fn:function(e){return i("div",{staticClass:"modal-header",attrs:{draggable:"true"},on:{dragstart:e.dragStart,dragend:e.dragEnd}},[i("span",{on:{click:function(e){t.$refs.title.select()}}},[i("i",{staticClass:"fas fa-pencil-alt",staticStyle:{"font-size":"15px"}})]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.note.title,expression:"note.title"}],ref:"title",domProps:{value:t.note.title},on:{change:t.updateNote,input:function(e){e.target.composing||t.$set(t.note,"title",e.target.value)}}}),i("div",{staticClass:"header-close",on:{click:function(e){t.visible=!1}}},[i("i",{staticClass:"far fa-window-close"})])])}}])},[i("div",{staticClass:"modal-body"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.note.text,expression:"note.text"}],ref:"textarea",style:{height:t.calcHeight()},domProps:{value:t.note.text},on:{change:t.updateNote,input:function(e){e.target.composing||t.$set(t.note,"text",e.target.value)}}})]),i("div",{staticClass:"modal-footer"},[i("button",{on:{click:t.removeNote}},[i("i",{staticClass:"far fa-trash-alt"}),t._v(" Remove\n    ")])])]):t._e()},Me=[],$e=s["default"].component("initiative-dialog",{data:()=>({visible:!1,note:null}),components:{modal:tt},methods:{open(t){this.visible=!0,this.note=t},calcHeight(){if(this.$refs.textarea){const t=this.$refs.textarea;return t.style.height="auto",t.style.height=t.scrollHeight+"px",t.scrollHeight+"px"}return"100px"},updateNote(){this.$store.commit("updateNote",{note:this.note,sync:!0})},removeNote(){Ms.$refs.confirm.open("Are you sure you wish to remove this?").then(t=>{t&&(this.$store.commit("removeNote",{note:this.note,sync:!0}),this.visible=!1)},()=>{})}}}),Ie=$e,De=(i("4370"),Object(a["a"])(Ie,Oe,Me,!1,null,"3ac7fb3c",null));De.options.__file="note.vue";var ze=De.exports,Te=function(){var t=this,e=t.$createElement,i=t._self._c||e;return null!==t.shape?i("div",[i("div",{attrs:{id:"selection-menu"}},[i("div",{attrs:{id:"selection-edit-button"},on:{click:t.openEditDialog}},[i("i",{staticClass:"fas fa-edit"})]),i("div",{attrs:{id:"selection-name"}},[t._v(t._s(t.shape.name))]),i("div",{attrs:{id:"selection-trackers"}},[t._l(t.shape.trackers,function(e){return""!==e.name||0!==e.value?[i("div",{key:"name-"+e.uuid},[t._v(t._s(e.name))]),i("div",{key:"value-"+e.uuid,staticClass:"selection-tracker-value",on:{click:function(i){t.changeValue(e,!1)}}},[0===e.maxvalue?[t._v(t._s(e.value))]:[t._v(t._s(e.value)+" / "+t._s(e.maxvalue))]],2)]:t._e()})],2),i("div",{attrs:{id:"selection-auras"}},[t._l(t.shape.auras,function(e){return""!==e.name||0!==e.value?[i("div",{key:"name-"+e.uuid},[t._v(t._s(e.name))]),i("div",{key:"value-"+e.uuid,staticClass:"selection-tracker-value",on:{click:function(i){t.changeValue(e,!0)}}},[0===e.dim?[t._v(t._s(e.value))]:[t._v(t._s(e.value)+" / "+t._s(e.dim))]],2)]:t._e()})],2)]),i("edit-dialog",{ref:"editDialog",attrs:{shape:t.shape}})],1):t._e()},Ae=[],Ne=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{visible:t.visible,mask:!1},on:{close:function(e){t.visible=!1}},scopedSlots:t._u([{key:"header",fn:function(e){return i("div",{staticClass:"modal-header",attrs:{draggable:"true"},on:{dragstart:e.dragStart,dragend:e.dragEnd}},[i("div",[t._v("Edit asset")]),i("div",{staticClass:"header-close",on:{click:function(e){t.visible=!1}}},[i("i",{staticClass:"far fa-window-close"})])])}}])},[i("div",{staticClass:"modal-body"},[i("label",{attrs:{for:"shapeselectiondialog-name"}},[t._v("Name")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.shape.name,expression:"shape.name"}],staticStyle:{"grid-column":"numerator / end"},attrs:{type:"text",id:"shapeselectiondialog-name"},domProps:{value:t.shape.name},on:{change:function(e){t.updateShape(!1)},input:function(e){e.target.composing||t.$set(t.shape,"name",e.target.value)}}}),i("label",{attrs:{for:"shapeselectiondialog-istoken"}},[t._v("Is a token")]),i("input",{staticStyle:{"grid-column-start":"remove",width:"15px",height:"15px"},attrs:{type:"checkbox",id:"shapeselectiondialog-istoken"},domProps:{checked:t.shape.isToken},on:{click:t.setToken}}),i("label",{attrs:{for:"shapeselectiondialog-visionblocker"}},[t._v("Blocks vision/light")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.shape.visionObstruction,expression:"shape.visionObstruction"}],staticStyle:{"grid-column-start":"remove",width:"15px",height:"15px"},attrs:{type:"checkbox",id:"shapeselectiondialog-visionblocker"},domProps:{checked:Array.isArray(t.shape.visionObstruction)?t._i(t.shape.visionObstruction,null)>-1:t.shape.visionObstruction},on:{change:[function(e){var i=t.shape.visionObstruction,s=e.target,o=!!s.checked;if(Array.isArray(i)){var n=null,a=t._i(i,n);s.checked?a<0&&t.$set(t.shape,"visionObstruction",i.concat([n])):a>-1&&t.$set(t.shape,"visionObstruction",i.slice(0,a).concat(i.slice(a+1)))}else t.$set(t.shape,"visionObstruction",o)},t.setVisionBlocker]}}),i("label",{attrs:{for:"shapeselectiondialog-moveblocker"}},[t._v("Blocks movement")]),i("input",{staticStyle:{"grid-column-start":"remove",width:"15px",height:"15px"},attrs:{type:"checkbox",id:"shapeselectiondialog-moveblocker"},domProps:{checked:t.shape.movementObstruction},on:{click:t.setMovementBlocker}}),i("div",{staticClass:"spanrow header"},[t._v("Access")]),t._l(t.shape.owners,function(e){return[i("input",{key:e,staticStyle:{"grid-column-start":"name"},attrs:{type:"text",placeholder:"name"},domProps:{value:e},on:{change:function(i){t.updateOwner(i,e)}}}),""!==e?i("div",{key:"remove-"+e,staticStyle:{"grid-column-start":"remove"},on:{click:function(i){t.removeOwner(e)}}},[i("i",{staticClass:"fas fa-trash-alt"})]):t._e()]}),i("div",{staticClass:"spanrow header"},[t._v("Trackers")]),t._l(t.shape.trackers,function(e){return[i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"tracker.name"}],key:"name-"+e.uuid,staticStyle:{"grid-column-start":"name"},attrs:{type:"text",placeholder:"name"},domProps:{value:e.name},on:{change:function(e){t.updateShape(!1)},input:function(i){i.target.composing||t.$set(e,"name",i.target.value)}}}),i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.value,expression:"tracker.value",modifiers:{number:!0}}],key:"value-"+e.uuid,attrs:{type:"text",title:"Current value"},domProps:{value:e.value},on:{change:function(e){t.updateShape(!1)},input:function(i){i.target.composing||t.$set(e,"value",t._n(i.target.value))},blur:function(e){t.$forceUpdate()}}}),i("span",{key:"fspan-"+e.uuid},[t._v("/")]),i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.maxvalue,expression:"tracker.maxvalue",modifiers:{number:!0}}],key:"maxvalue-"+e.uuid,attrs:{type:"text",title:"Current value"},domProps:{value:e.maxvalue},on:{change:function(e){t.updateShape(!1)},input:function(i){i.target.composing||t.$set(e,"maxvalue",t._n(i.target.value))},blur:function(e){t.$forceUpdate()}}}),i("span",{key:"sspan-"+e.uuid}),i("div",{key:"visibility-"+e.uuid,style:{opacity:e.visible?1:.3},on:{click:function(i){e.visible=!e.visible,t.updateShape(!1)}}},[i("i",{staticClass:"fas fa-eye"})]),i("span",{key:"tspan-"+e.uuid}),""!==e.name||0!==e.value?i("div",{key:"remove-"+e.uuid,on:{click:function(i){t.removeTracker(e.uuid)}}},[i("i",{staticClass:"fas fa-trash-alt"})]):t._e()]}),i("div",{staticClass:"spanrow header"},[t._v("Auras")]),t._l(t.shape.auras,function(e){return[i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"aura.name"}],key:"name-"+e.uuid,staticStyle:{"grid-column-start":"name"},attrs:{type:"text",placeholder:"name"},domProps:{value:e.name},on:{change:function(e){t.updateShape(!1)},input:function(i){i.target.composing||t.$set(e,"name",i.target.value)}}}),i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.value,expression:"aura.value",modifiers:{number:!0}}],key:"value-"+e.uuid,attrs:{type:"text",title:"Current value"},domProps:{value:e.value},on:{change:function(e){t.updateShape(!0)},input:function(i){i.target.composing||t.$set(e,"value",t._n(i.target.value))},blur:function(e){t.$forceUpdate()}}}),i("span",{key:"fspan-"+e.uuid},[t._v("/")]),i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.dim,expression:"aura.dim",modifiers:{number:!0}}],key:"dimvalue-"+e.uuid,attrs:{type:"text",title:"Dim value"},domProps:{value:e.dim},on:{change:function(e){t.updateShape(!0)},input:function(i){i.target.composing||t.$set(e,"dim",t._n(i.target.value))},blur:function(e){t.$forceUpdate()}}}),i("color-picker",{key:"colour-"+e.uuid,attrs:{color:e.colour},on:{"update:color":function(i){t.$set(e,"colour",i)},input:function(i){t.updateAuraColour(e,i)},change:function(e){t.updateShape(!0)}}}),i("div",{key:"visibility-"+e.uuid,style:{opacity:e.visible?1:.3},on:{click:function(i){e.visible=!e.visible,t.updateShape(!0)}}},[i("i",{staticClass:"fas fa-eye"})]),i("div",{key:"visionsource-"+e.uuid,style:{opacity:e.visionSource?1:.3},on:{click:function(i){t.updateAuraVisionSource(e)}}},[i("i",{staticClass:"fas fa-lightbulb"})]),""!==e.name||0!==e.value?i("div",{key:"remove-"+e.uuid,on:{click:function(i){t.removeAura(e.uuid)}}},[i("i",{staticClass:"fas fa-trash-alt"})]):t._e()]}),i("div",{staticClass:"spanrow header"},[t._v("Annotation")]),i("textarea",{staticClass:"spanrow",domProps:{value:t.shape.annotation},on:{change:t.updateAnnotation}})],2)])},Be=[],Re=s["default"].component("edit-dialog",{components:{modal:tt,"color-picker":ge},props:{shape:Object},data:()=>({visible:!1}),updated(){this.addEmpty()},methods:{addEmpty(){""!==this.shape.owners[this.shape.owners.length-1]&&this.shape.owners.push(""),this.shape.trackers.length&&""===this.shape.trackers[this.shape.trackers.length-1].name&&0===this.shape.trackers[this.shape.trackers.length-1].value||this.shape.trackers.push({uuid:Ct(),name:"",value:0,maxvalue:0,visible:!1}),this.shape.auras.length&&""===this.shape.auras[this.shape.auras.length-1].name&&0===this.shape.auras[this.shape.auras.length-1].value||this.shape.auras.push({uuid:Ct(),name:"",value:0,dim:0,visionSource:!1,colour:"rgba(0,0,0,0)",visible:!1})},updateShape(t){_t.emit("Shape.Update",{shape:this.shape.asDict(),redraw:t,temporary:!1}),t&&te.invalidate(),this.addEmpty()},setToken(t){this.shape.setIsToken(t.target.checked),this.updateShape(!0)},setVisionBlocker(t){this.shape.checkVisionSources(),this.updateShape(!0)},setMovementBlocker(t){this.shape.setMovementBlock(t.target.checked),this.updateShape(!1)},updateAnnotation(t){const e=""!==this.shape.annotation;this.shape.annotation=t.target.value,""===this.shape.annotation||e?""===this.shape.annotation&&e&&(Vt.annotations.splice(Vt.annotations.findIndex(t=>t===this.shape.uuid)),te.hasLayer("draw")&&te.getLayer("draw").invalidate(!0)):(Vt.annotations.push(this.shape.uuid),te.hasLayer("draw")&&te.getLayer("draw").invalidate(!0)),this.updateShape(!1)},updateOwner(t,e){const i=this.shape.owners.findIndex(t=>t===e);i>=0?this.shape.owners.splice(i,1,t.target.value):this.shape.owners.push(t.target.value),this.updateShape(this.$store.state.game.fowLOS)},removeOwner(t){const e=this.shape.owners.findIndex(e=>e===t);this.shape.owners.splice(e,1),this.updateShape(this.$store.state.game.fowLOS)},removeTracker(t){this.shape.trackers=this.shape.trackers.filter(e=>e.uuid!==t),this.updateShape(!1)},removeAura(t){this.shape.auras=this.shape.auras.filter(e=>e.uuid!==t),this.shape.checkVisionSources(),this.updateShape(!0)},updateAuraVisionSource(t){t.visionSource=!t.visionSource;const e=Vt.visionSources.findIndex(e=>e.aura===t.uuid);t.visionSource&&-1===e?Vt.visionSources.push({shape:this.shape.uuid,aura:t.uuid}):!t.visionSource&&e>=0&&Vt.visionSources.splice(e,1),te.invalidateLight(),this.updateShape(!0)},updateAuraColour(t,e){const i=te.getLayer(this.shape.layer);void 0!==i&&i.invalidate(!t.visionSource)}}}),Ue=Re,Ee=(i("57f2"),Object(a["a"])(Ue,Ne,Be,!1,null,"16427a8e",null));Ee.options.__file="edit_dialog.vue";var Fe=Ee.exports,He=s["default"].extend({components:{"edit-dialog":Fe},data:()=>({shape:null}),methods:{openEditDialog(){this.$refs.editDialog.visible=!0},changeValue(t,e){null!==this.shape&&Ms.$refs.prompt.prompt(`New  ${t.name} value:`,`Updating ${t.name}`).then(i=>{if(null===this.shape)return;const s=t.value;"+"===i[0]||"-"===i[0]?t.value+=parseInt(i,10):t.value=parseInt(i,10),isNaN(t.value)&&(t.value=s),_t.emit("Shape.Update",{shape:this.shape.asDict(),redraw:e,temporary:!1}),e&&te.invalidate()},()=>{})}}}),Ge=He,We=(i("8e03"),Object(a["a"])(Ge,Te,Ae,!1,null,"75b524c1",null));We.options.__file="selection_info.vue";var je=We.exports,Ve=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{attrs:{id:"toolselect"}},[i("ul",t._l(t.tools,function(e){return!t.dmTools.includes(e)||t.IS_DM?i("li",{key:e,ref:e+"-selector",refInFor:!0,class:{"tool-selected":t.currentTool===e},on:{click:function(i){t.currentTool=e}}},[i("a",{attrs:{href:"#"}},[t._v(t._s(e))])]):t._e()}))]),i("div",[[i("select-tool",{directives:[{name:"show",rawName:"v-show",value:"Select"===t.currentTool,expression:"currentTool === 'Select'"}],ref:"selectTool"}),i("pan-tool",{directives:[{name:"show",rawName:"v-show",value:"Pan"===t.currentTool,expression:"currentTool === 'Pan'"}]}),i("keep-alive",[i("draw-tool",{directives:[{name:"show",rawName:"v-show",value:"Draw"===t.currentTool,expression:"currentTool === 'Draw'"}]})],1),i("ruler-tool",{directives:[{name:"show",rawName:"v-show",value:"Ruler"===t.currentTool,expression:"currentTool === 'Ruler'"}]}),i("map-tool",{directives:[{name:"show",rawName:"v-show",value:"Map"===t.currentTool,expression:"currentTool === 'Map'"}]}),i("shape-menu",{ref:"shapecontext"}),i("createtoken-dialog",{ref:"createtokendialog"})]],2)])},Ye=[];function Xe(t){return new pt(t.pageX,t.pageY)}function qe(t=!1){const e=yt()(Vt.fowColour);return Vt.IS_DM?e.setAlpha(t?1:Vt.fowOpacity):e.setAlpha(1),e.toRgbString()}class Je extends Zt{constructor(t,e,i,s,o,n){super(t,e,i,s,o,n),this.type="rect"}asDict(){return super.getBaseDict()}draw(t){super.draw(t),"fog"===this.fillColour?t.fillStyle=qe():t.fillStyle=this.fillColour;const e=Vt.zoomFactor,i=Dt(this.refPoint);t.fillRect(i.x,i.y,this.w*e,this.h*e),"rgba(0, 0, 0, 0)"!==this.strokeColour&&(t.strokeStyle=this.strokeColour,t.lineWidth=5,t.strokeRect(i.x,i.y,this.w*e,this.h*e))}}class Ze extends qt{constructor(t,e,i,s,o,n,a){super(t,o,n,a),this.type="text",this.text=e,this.font=i,this.angle=s||0}asDict(){return Object.assign(this.getBaseDict(),{text:this.text,font:this.font,angle:this.angle})}getBoundingBox(){return new vt(this.refPoint,5,5)}draw(t){super.draw(t),t.font=this.font,t.fillStyle=this.fillColour,t.save();const e=Dt(this.refPoint);t.translate(e.x,e.y),t.rotate(this.angle),t.textAlign="center",this.getLines(t).map(e=>t.fillText(e.text,e.x,e.y)),t.restore()}contains(t){return!1}center(t){}getCorner(t){return""}visibleInCanvas(t){return!0}snapToGrid(){}resizeToGrid(){}resize(t,e){}getMaxHeight(t){const e=this.getLines(t),i=30;return i*e.length}getMaxWidth(t){const e=this.getLines(t),i=e.map(e=>t.measureText(e.text).width);return Math.max(...i)}getLines(t){const e=this.text.split("\n"),i=[],s=t.canvas.width,o=30,n=0;let a=0;for(const r of e){let e="";const l=r.split(" ");for(const r of l){const l=e+r+" ",c=t.measureText(l),u=c.width;u>s?(t.fillText(e,n,a),i.push({text:e,x:n,y:a}),e=r+" ",a+=o):e=l}i.push({text:e,x:n,y:a}),a+=o}return i}}class Ke{constructor(){this.shown=!1;const t=new dt(0,0);this.annotationText=new Ze(t,"","bold 20px serif",0,"rgba(230, 230, 230, 1)"),this.annotationRect=new Je(t,0,0,"rgba(0, 0, 0, 0.6)")}setActiveText(t){if(void 0===this.layer){if(!te.hasLayer("draw"))return void console.warn("There is no draw layer to draw annotations on!");this.layer=te.getLayer("draw"),this.layer.addShape(this.annotationRect,!1),this.layer.addShape(this.annotationText,!1)}this.shown=""!==t,this.annotationText.refPoint=Rt(new pt(this.layer.canvas.width/2,50)),this.annotationText.text=t;const e=this.shown?this.annotationText.getMaxWidth(this.layer.ctx)+10:0,i=this.shown?this.annotationText.getMaxHeight(this.layer.ctx)+10:0;this.annotationRect.refPoint=Rt(new pt(this.layer.canvas.width/2-e/2,30)),this.annotationRect.w=e/Vt.zoomFactor,this.annotationRect.h=i/Vt.zoomFactor,this.layer.invalidate(!0)}}var Qe=Ke;class ti extends qt{constructor(t,e,i,s,o){super(t,i,s,o),this.type="circle",this.r=e||1}asDict(){return Object.assign(this.getBaseDict(),{radius:this.r})}fromDict(t){super.fromDict(t),this.r=t.radius}getBoundingBox(){return new vt(new dt(this.refPoint.x-this.r,this.refPoint.y-this.r),2*this.r,2*this.r)}draw(t){super.draw(t),t.beginPath(),"fog"===this.fillColour?t.fillStyle=qe():t.fillStyle=this.fillColour;const e=Dt(this.refPoint);t.arc(e.x,e.y,At(this.r),0,2*Math.PI),t.fill(),"rgba(0, 0, 0, 0)"!==this.strokeColour&&(t.beginPath(),t.lineWidth=At(5),t.strokeStyle=this.strokeColour,t.arc(e.x,e.y,At(this.r),0,2*Math.PI),t.stroke())}contains(t){return Math.pow(t.x-this.refPoint.x,2)+Math.pow(t.y-this.refPoint.y,2)<Math.pow(this.r,2)}inCorner(t,e){return!1}getCorner(t){return this.inCorner(t,"ne")?"ne":this.inCorner(t,"nw")?"nw":this.inCorner(t,"se")?"se":this.inCorner(t,"sw")?"sw":void 0}center(t){if(void 0===t)return this.refPoint;this.refPoint=t}visibleInCanvas(t){return!0}snapToGrid(){const t=Vt.gridSize;let e,i;e=2*this.r/t%2===0?Math.round(this.refPoint.x/t)*t:Math.round((this.refPoint.x-t/2)/t)*t+this.r,i=2*this.r/t%2===0?Math.round(this.refPoint.y/t)*t:Math.round((this.refPoint.y-t/2)/t)*t+this.r;const s=Jt(new ft(e-this.refPoint.x,i-this.refPoint.y),this);this.refPoint=this.refPoint.add(s),this.invalidate(!1)}resizeToGrid(){const t=Vt.gridSize;this.r=Math.max(Math.round(this.r/t)*t,t/2),this.invalidate(!1)}resize(t,e){Vt.zoomFactor;const i=Rt(e).subtract(this.refPoint);this.r=Math.sqrt(Math.pow(i.length(),2)/2)}}class ei extends ti{constructor(t,e,i,s,o,n,a){super(t,e,o,n,a),this.type="circulartoken",this.text=i,this.font=s}asDict(){return Object.assign(this.getBaseDict(),{radius:this.r,text:this.text,font:this.font})}fromDict(t){super.fromDict(t),this.r=t.radius,this.text=t.text,this.font=t.font}draw(t){super.draw(t),t.font=this.font,t.save();const e=Dt(this.center());t.textAlign="center",t.textBaseline="middle";const i=Lt(t,this.text,At(this.r),At(this.r)),s=0;t.transform(i,s,-s,i,e.x,e.y),t.fillStyle=gt["mostReadable"](this.fillColour,["#000","#fff"]).toHexString(),t.fillText(this.text,0,0),t.restore()}getInitiativeRepr(){return{uuid:this.uuid,visible:!Vt.IS_DM,group:!1,source:""===this.name||"Unknown shape"===this.name?this.text:this.name,has_img:!1,effects:[],index:1/0}}}class ii extends qt{constructor(t,e,i,s,o){super(t,"rgba(0, 0, 0, 0)",s||"#000",o),this.type="line",this.endPoint=e,this.lineWidth=void 0===i?1:i}asDict(){return Object.assign(this.getBaseDict(),{x2:this.endPoint.x,y2:this.endPoint.y,lineWidth:this.lineWidth})}getBoundingBox(){return new vt(new dt(Math.min(this.refPoint.x,this.endPoint.x),Math.min(this.refPoint.x,this.endPoint.y)),Math.abs(this.refPoint.x-this.endPoint.x),Math.abs(this.refPoint.y-this.endPoint.y))}draw(t){super.draw(t),t.strokeStyle=this.strokeColour,t.beginPath(),t.moveTo(zt(this.refPoint.x),Tt(this.refPoint.y)),t.lineTo(zt(this.endPoint.x),Tt(this.endPoint.y)),t.lineWidth=this.lineWidth,t.stroke()}contains(t){return!1}center(t){}getCorner(t){return""}visibleInCanvas(t){return!0}snapToGrid(){}resizeToGrid(){}resize(t,e){}}class si extends qt{constructor(t,e,i,s,o){super(t,"rgba(0, 0, 0, 0)",s||"#000",o),this.type="multiline",this.points=[],this.points=e||[],this.size=i||3}asDict(){return Object.assign(this.getBaseDict(),{size:this.size,points:this.points.map(t=>({x:t.x,y:t.y}))})}getBoundingBox(){let t=this.refPoint.x,e=this.refPoint.y,i=this.refPoint.x,s=this.refPoint.y;for(const o of this.points)o.x<t&&(t=o.x),o.x>e&&(e=o.x),o.y<i&&(i=o.y),o.y>s&&(s=o.y);return new vt(new dt(t,i),e-t,s-i)}draw(t){super.draw(t),t.beginPath(),t.lineCap="round",t.lineJoin="round",t.moveTo(zt(this.refPoint.x),Tt(this.refPoint.y));for(const e of this.points)t.lineTo(zt(e.x),Tt(e.y));"fog"===this.strokeColour?t.strokeStyle=qe():t.strokeStyle=this.strokeColour,t.lineWidth=At(this.size),t.stroke()}contains(t){return this.points.includes(t)}center(t){}getCorner(t){return""}visibleInCanvas(t){return!0}snapToGrid(){}resizeToGrid(){}resize(t,e){}}function oi(t,e){if(void 0===e&&(e=!1),!e&&te.UUIDMap.has(t.uuid))return te.UUIDMap.get(t.uuid);let i;const s=new dt(t.x,t.y);if("rect"===t.type_){const e=t;i=new Je(s,e.width,e.height,e.fill_colour,e.stroke_colour,e.uuid)}else if("circle"===t.type_){const e=t;i=new ti(s,e.radius,e.fill_colour,e.stroke_colour,e.uuid)}else if("circulartoken"===t.type_){const e=t;i=new ei(s,e.radius,e.text,e.font,e.fill_colour,e.stroke_colour,e.uuid)}else if("line"===t.type_){const e=t;i=new ii(s,new dt(e.x2,e.y2),e.lineWidth,e.stroke_colour,e.uuid)}else if("multiline"===t.type_){const e=t;i=new si(s,e.points.map(t=>new dt(t.x,t.y)),e.size,e.stroke_colour,e.uuid)}else if("text"===t.type_){const e=t;i=new Ze(s,e.text,e.font,e.angle,e.fill_colour,e.stroke_colour,e.uuid)}else{if("assetrect"!==t.type_)return;{const e=t,o=new Image(e.width,e.height);e.src.startsWith("http")?o.src=new URL(e.src).pathname:o.src=e.src,i=new Kt(o,s,e.width,e.height,e.uuid),o.onload=(()=>{te.getLayer(t.layer).invalidate(!1)})}}return i.fromDict(t),i}class ni{constructor(){this.selectedTool=0,this.annotationManager=new Qe}addShape(t){if(!te.hasLayer(t.layer))return void console.log(`Shape with unknown layer ${t.layer} could not be added`);const e=te.getLayer(t.layer),i=oi(t);void 0!==i?(e.addShape(i,!1),e.invalidate(!1)):console.log(`Shape with unknown type ${t.type_} could not be added`)}updateShape(t){if(!te.hasLayer(t.shape.layer))return void console.log(`Shape with unknown layer ${t.shape.layer} could not be added`);const e=oi(t.shape,!0);if(void 0===e)return void console.log(`Shape with unknown type ${t.shape.type_} could not be added`);const i=te.UUIDMap.get(t.shape.uuid);if(void 0===i)return void console.log("Shape with unknown id could not be updated");const s=e.owners!==i.owners,o=Object.assign(i,e);o.checkVisionSources(),o.setMovementBlock(o.movementObstruction),o.setIsToken(o.isToken),t.move&&o.visionObstruction&&Vt.recalculateBV(),t.redraw&&te.getLayer(t.shape.layer).invalidate(!1),s&&Ms.$refs.initiative.$forceUpdate()}setCenterPosition(t){Dt(t);te.invalidate(),Wt()}}const ai=new ni;window.gameManager=ai;var ri=ai,li=function(){var t=this,e=t.$createElement,i=t._self._c||e;return void 0!==t.getActiveLayer()?i("contextmenu",{attrs:{visible:t.visible,left:t.x+"px",top:t.y+"px"},on:{close:t.close}},[t.getLayers().length>1?i("li",[t._v("Layer\n        "),i("ul",t._l(t.getLayers(),function(e){return i("li",{key:e.name,style:[t.getActiveLayer().name===e.name?{"background-color":"#82c8a0"}:{}],on:{click:function(i){t.setLayer(e.name)}}},[t._v("\n                "+t._s(e.name)+"\n            ")])}))]):t._e(),i("li",{on:{click:t.moveToBack}},[t._v("Move to back")]),i("li",{on:{click:t.moveToFront}},[t._v("Move to front")]),i("li",{on:{click:t.addInitiative}},[t._v(t._s(t.getInitiativeWord())+" initiative")])]):t._e()},ci=[],ui=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.visible?i("div",{staticClass:"ContextMenu",style:{left:t.left,top:t.top},attrs:{tabindex:"-1"},on:{blur:function(e){t.$emit("close")}}},[i("ul",[t._t("default")],2)]):t._e()},hi=[],di={props:["visible","left","top"]},pi=di,fi=(i("7f1e"),Object(a["a"])(pi,ui,hi,!1,null,null,null));fi.options.__file="contextmenu.vue";var mi=fi.exports,vi=s["default"].component("shape-menu",{components:{contextmenu:mi},data:()=>({visible:!1,x:0,y:0,shape:null}),computed:{activeLayer:()=>{const t=te.getLayer();return void 0===t?"":t.name}},methods:{open(t,e){this.visible=!0,this.x=t.pageX,this.y=t.pageY,this.shape=e,this.$nextTick(()=>this.$children[0].$el.focus())},close(){this.visible=!1,this.shape=null},getLayers(){return te.layers.filter(t=>t.selectable&&(this.$store.state.game.IS_DM||t.playerEditable))},getActiveLayer(){return te.getLayer()},getInitiativeWord(){if(null===this.shape)return"";const t=Ms.$refs.initiative;return t.contains(this.shape.uuid)?"Show":"Add"},setLayer(t){null!==this.shape&&(this.shape.moveLayer(t,!0),this.close())},moveToBack(){if(null===this.shape)return;const t=this.getActiveLayer();t.moveShapeOrder(this.shape,0,!0),this.close()},moveToFront(){if(null===this.shape)return;const t=this.getActiveLayer();t.moveShapeOrder(this.shape,t.shapes.length-1,!0),this.close()},addInitiative(){if(null===this.shape)return;const t=Ms.$refs.initiative;t.contains(this.shape.uuid)||t.addInitiative(this.shape.getInitiativeRepr()),t.visible=!0,this.close()}}}),gi=vi,yi=(i("a6ac"),Object(a["a"])(gi,li,ci,!1,null,"e2ea3ef2",null));yi.options.__file="shapecontext.vue";var wi=yi.exports,xi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{visible:t.visible},on:{close:function(e){t.visible=!1}},scopedSlots:t._u([{key:"header",fn:function(e){return i("div",{staticClass:"modal-header",attrs:{draggable:"true"},on:{dragstart:e.dragStart,dragend:e.dragEnd}},[t._v("Create basic token")])}}])},[i("div",{staticClass:"modal-body"},[i("label",{attrs:{for:"createtokendialog-text"}},[t._v("Text")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],attrs:{type:"text",id:"createtokendialog-name"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}}),i("label",[t._v("Colours")]),i("div",{staticClass:"colours"},[i("span",[t._v("Fill:")]),i("color-picker",{attrs:{color:t.fillColour},on:{"update:color":function(e){t.fillColour=e}}}),i("span",[t._v("Border:")]),i("color-picker",{attrs:{color:t.borderColour},on:{"update:color":function(e){t.borderColour=e}}})],1),i("canvas",{ref:"canvas",attrs:{width:"100px",height:"100px"}})]),i("div",{staticClass:"modal-footer"},[i("button",{on:{click:t.submit}},[t._v("Submit")])])])},bi=[],Si=s["default"].component("createtoken-modal",{components:{modal:tt,"color-picker":ge},data:()=>({x:0,y:0,visible:!1,text:"X",fillColour:"rgba(255, 255, 255, 1)",borderColour:"rgba(0, 0, 0, 1)"}),computed:Object.assign({},Object(_["c"])("game",["unitSize"])),watch:{text(t,e){this.updatePreview()},fillColour(t,e){this.updatePreview()},borderColour(t,e){this.updatePreview()}},mounted(){this.updatePreview()},methods:{open(t,e){this.visible=!0,this.x=t,this.y=e},submit(){const t=te.getLayer();if(void 0===t)return;const e=new ei(Rt(new pt(this.x,this.y)),Nt(this.unitSize/2),this.text,"10px serif",this.fillColour,this.borderColour);e.owners.push(this.$store.state.username),t.addShape(e,!0),t.invalidate(!1),this.visible=!1},updatePreview(){const t=this.$refs.canvas.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height),t.beginPath();const e={x:t.canvas.width/2,y:t.canvas.height/2},i=.9*Math.min(e.x,e.y);t.fillStyle=this.fillColour,t.arc(e.x,e.y,i,0,2*Math.PI),t.fill(),"rgba(0, 0, 0, 0)"!==this.borderColour&&(t.beginPath(),t.lineWidth=5,t.strokeStyle=this.borderColour,t.arc(e.x,e.y,i,0,2*Math.PI),t.stroke()),t.save(),t.textAlign="center",t.textBaseline="middle";const s=Lt(t,this.text,i,i),o=0;t.transform(s,o,-o,s,e.x,e.y),t.fillStyle=gt["mostReadable"](this.fillColour,["#000","#fff"]).toHexString(),t.fillText(this.text,0,0),t.restore()}}}),_i=Si,Ci=(i("ee6a"),Object(a["a"])(_i,xi,bi,!1,null,"2ebb16e9",null));Ci.options.__file="createtoken_modal.vue";var ki=Ci.exports,Pi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.selected?i("div",{staticClass:"tool-detail",style:{"--detailRight":t.detailRight,"--detailArrow":t.detailArrow}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.IS_DM,expression:"IS_DM"}]},[t._v("Mode")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.IS_DM,expression:"IS_DM"}],staticClass:"selectgroup"},t._l(t.modes,function(e){return i("div",{key:e,staticClass:"option",class:{"option-selected":t.modeSelect===e},on:{click:function(i){t.modeSelect=e}}},[t._v(t._s(e))])})),i("div",[t._v("Shape")]),i("div",{staticClass:"selectgroup"},t._l(t.shapes,function(e){return i("div",{key:e,staticClass:"option",class:{"option-selected":t.shapeSelect===e},on:{click:function(i){t.shapeSelect=e}}},[i("i",{staticClass:"fas",class:"fa-"+e})])})),i("div",[t._v("Colours")]),i("div",{staticClass:"selectgroup"},[i("color-picker",{staticClass:"option",attrs:{color:t.fillColour},on:{"update:color":function(e){t.fillColour=e}}}),i("color-picker",{staticClass:"option",attrs:{color:t.borderColour},on:{"update:color":function(e){t.borderColour=e}}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"paint-brush"===t.shapeSelect,expression:"shapeSelect === 'paint-brush'"}]},[t._v("Brush size")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.brushSize,expression:"brushSize"},{name:"show",rawName:"v-show",value:"paint-brush"===t.shapeSelect,expression:"shapeSelect === 'paint-brush'"}],staticStyle:{"max-width":"100px"},attrs:{type:"text"},domProps:{value:t.brushSize},on:{input:function(e){e.target.composing||(t.brushSize=e.target.value)}}})]):t._e()},Li=[],Oi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div")},Mi=[],$i=s["default"].component("tool",{data:()=>({name:"",selected:!1,active:!1}),computed:{detailRight(){const t=this.$parent.$refs[this.name+"-selector"][0].getBoundingClientRect(),e=t.left+t.width/2;return`${window.innerWidth-Math.min(window.innerWidth-25,e+75)}px`},detailArrow(){const t=this.$parent.$refs[this.name+"-selector"][0].getBoundingClientRect(),e=t.left+t.width/2,i=Math.min(window.innerWidth-25,e+75);return`${i-e-14}px`}},created(){this.$parent.$on("mousedown",(t,e)=>{e===this.name&&this.onMouseDown(t)}),this.$parent.$on("mouseup",(t,e)=>{e===this.name&&this.onMouseUp(t)}),this.$parent.$on("mousemove",(t,e)=>{e===this.name&&this.onMouseMove(t)}),this.$parent.$on("contextmenu",(t,e)=>{e===this.name&&this.onContextMenu(t)}),this.$parent.$on("tools-select-change",(t,e)=>{e===this.name?(this.selected=!1,this.onDeselect()):t===this.name&&(this.selected=!0,this.onSelect())})},methods:{onSelect(){},onDeselect(){},onMouseDown(t){},onMouseUp(t){},onMouseMove(t){},onContextMenu(t){}}}),Ii=$i,Di=(i("12d3"),Object(a["a"])(Ii,Oi,Mi,!1,null,null,null));Di.options.__file="tool.vue";var zi=Di.exports,Ti=zi.extend({components:{"color-picker":ge},data:()=>({name:"Draw",active:!1,startPoint:null,shape:null,brushHelper:null,fillColour:"rgba(0, 0, 0, 1)",borderColour:"rgba(255, 255, 255, 0)",shapeSelect:"square",shapes:["square","circle","paint-brush"],modeSelect:"normal",modes:["normal","reveal","hide"],brushSize:Nt(Vt.unitSize)}),computed:{helperSize(){return"paint-brush"===this.shapeSelect?this.brushSize/2:Nt(this.unitSize)/8},IS_DM(){return this.$store.state.game.IS_DM},unitSize(){return this.$store.state.game.unitSize},useGrid(){return this.$store.state.game.useGrid}},watch:{fillColour(){this.brushHelper&&(this.brushHelper.fillColour=this.fillColour)},modeSelect(t,e){this.onModeChange(t,e)}},methods:{setupBrush(){null!==this.brushHelper&&("reveal"===this.modeSelect||"hide"===this.modeSelect?(this.brushHelper.options.set("preFogShape",!0),this.brushHelper.options.set("skipDraw",!0),this.brushHelper.fillColour="rgba(0, 0, 0, 1)","reveal"===this.modeSelect?this.brushHelper.globalCompositeOperation="source-over":"hide"===this.modeSelect&&(this.brushHelper.globalCompositeOperation="destination-out")):(this.brushHelper.options.delete("preFogShape"),this.brushHelper.options.delete("skipDraw"),this.brushHelper.globalCompositeOperation="source-over",this.brushHelper.fillColour=this.fillColour))},onModeChange(t,e){if(null===this.brushHelper)return;const i=te.getLayer("fow"),s=te.getLayer();void 0!==i&&void 0!==s&&(this.setupBrush(),"normal"!==t&&"normal"===e?(s.removeShape(this.brushHelper,!1),i.addShape(this.brushHelper,!1)):"normal"===t&&"normal"!==e&&(s.addShape(this.brushHelper,!1),i.removeShape(this.brushHelper,!1)))},getLayer(){return"normal"===this.modeSelect?te.getLayer():te.getLayer("fow")},onMouseDown(t){const e=this.getLayer();if(void 0!==e){if(this.active=!0,this.startPoint=Rt(Xe(t)),"square"===this.shapeSelect)this.shape=new Je(this.startPoint.clone(),0,0,this.fillColour,this.borderColour);else if("circle"===this.shapeSelect)this.shape=new ti(this.startPoint.clone(),this.helperSize,this.fillColour,this.borderColour);else{if("paint-brush"!==this.shapeSelect)return;this.shape=new si(this.startPoint.clone(),[],this.brushSize),this.shape.fillColour=this.fillColour}"normal"!==this.modeSelect&&(this.shape.options.set("preFogShape",!0),this.shape.options.set("skipDraw",!0),this.shape.fillColour="rgba(0, 0, 0, 1)"),"reveal"===this.modeSelect?this.shape.globalCompositeOperation="source-over":"hide"===this.modeSelect&&(this.shape.globalCompositeOperation="destination-out"),this.shape.owners.push(this.$store.state.game.username),"fow"===e.name&&"normal"===this.modeSelect&&(this.shape.visionObstruction=!0,this.shape.movementObstruction=!0),Vt.visionBlockers.push(this.shape.uuid),e.addShape(this.shape,!0,!1),this.onDeselect(),this.onSelect()}else console.log("No active layer!")},onMouseMove(t){const e=Rt(Xe(t)),i=this.getLayer();void 0!==i?(null!==this.brushHelper&&(this.brushHelper.r=this.helperSize,this.brushHelper.refPoint=e,this.active||i.invalidate(!1)),this.active&&null!==this.startPoint&&null!==this.shape&&("square"===this.shapeSelect?(this.shape.w=Math.abs(e.x-this.startPoint.x),this.shape.h=Math.abs(e.y-this.startPoint.y),this.shape.refPoint.x=Math.min(this.startPoint.x,e.x),this.shape.refPoint.y=Math.min(this.startPoint.y,e.y)):"circle"===this.shapeSelect?this.shape.r=e.subtract(this.startPoint).length():"paint-brush"===this.shapeSelect&&this.shape.points.push(e),_t.emit("Shape.Update",{shape:this.shape.asDict(),redraw:!0,temporary:!1}),this.shape.visionObstruction&&Vt.recalculateBV(),i.invalidate(!1))):console.log("No active layer!")},onMouseUp(t){this.active&&null!==this.shape&&!t.altKey&&this.useGrid&&(this.shape.resizeToGrid(),_t.emit("Shape.Update",{shape:this.shape.asDict(),redraw:!0,temporary:!1})),this.active=!1},onSelect(){const t=this.getLayer();void 0!==t&&(this.brushHelper=new ti(new dt(-1e3,-1e3),this.brushSize/2,this.fillColour),this.setupBrush(),t.addShape(this.brushHelper,!1))},onDeselect(){const t=this.getLayer();null!==this.brushHelper&&void 0!==t&&t.removeShape(this.brushHelper,!1)}}}),Ai=Ti,Ni=(i("c730"),Object(a["a"])(Ai,Pi,Li,!1,null,"04c29104",null));Ni.options.__file="draw.vue";var Bi=Ni.exports,Ri=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.selected?i("div",{staticClass:"tool-detail",style:{"--detailRight":t.detailRight,"--detailArrow":t.detailArrow}},[i("div",[t._v("#X")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.xCount,expression:"xCount"}],attrs:{type:"text"},domProps:{value:t.xCount},on:{input:function(e){e.target.composing||(t.xCount=e.target.value)}}}),i("div",[t._v("#Y")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.yCount,expression:"yCount"}],attrs:{type:"text"},domProps:{value:t.yCount},on:{input:function(e){e.target.composing||(t.yCount=e.target.value)}}})]):t._e()},Ui=[],Ei=zi.extend({data:()=>({name:"Map",active:!1,xCount:3,yCount:3,startPoint:null,rect:null}),computed:Object.assign({},Object(_["c"])("game",["gridSize"])),methods:{onMouseDown(t){const e=te.getLayer();void 0!==e?(this.active=!0,this.startPoint=Rt(Xe(t)),this.rect=new Je(this.startPoint.clone(),0,0,"rgba(0,0,0,0)","black"),e.addShape(this.rect,!1,!1)):console.log("No active layer!")},onMouseMove(t){if(!this.active||null===this.rect||null===this.startPoint)return;const e=te.getLayer();if(void 0===e)return void console.log("No active layer!");const i=Rt(Xe(t));this.rect.w=Math.abs(i.x-this.startPoint.x),this.rect.h=Math.abs(i.y-this.startPoint.y),this.rect.refPoint.x=Math.min(this.startPoint.x,i.x),this.rect.refPoint.y=Math.min(this.startPoint.y,i.y),e.invalidate(!1)},onMouseUp(t){if(!this.active||null===this.rect)return;const e=te.getLayer();if(void 0===e)return void console.log("No active layer!");if(this.active=!1,1!==e.selection.length)return void e.removeShape(this.rect,!1,!1);const i=this.rect.w,s=this.rect.h,o=e.selection[0];o instanceof Zt&&(o.w*=this.xCount*this.gridSize/i,o.h*=this.yCount*this.gridSize/s),e.removeShape(this.rect,!1,!1)}}}),Fi=Ei,Hi=Object(a["a"])(Fi,Ri,Ui,!1,null,null,null);Hi.options.__file="map.vue";var Gi=Hi.exports,Wi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div")},ji=[],Vi=zi.extend({data:()=>({name:"Pan",panStart:new pt(0,0),active:!1}),computed:Object.assign({},Object(_["c"])("game",["zoomFactor","panX","panY"])),methods:{onMouseDown(t){this.panStart=Xe(t),this.active=!0},onMouseMove(t){if(!this.active)return;const e=Xe(t),i=e.subtract(this.panStart).multiply(1/this.zoomFactor);Vt.increasePanX(Math.round(i.x)),Vt.increasePanY(Math.round(i.y)),this.panStart=e,te.invalidate()},onMouseUp(t){this.active=!1,Wt()}}}),Yi=Vi,Xi=Object(a["a"])(Yi,Wi,ji,!1,null,null,null);Xi.options.__file="pan.vue";var qi=Xi.exports,Ji=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div")},Zi=[],Ki=zi.extend({data:()=>({name:"Ruler",active:!1,startPoint:null,ruler:null,text:null}),computed:Object.assign({},Object(_["c"])("game",["username","gridSize","unitSize"])),methods:{onMouseDown(t){const e=te.getLayer("draw");void 0!==e?(this.active=!0,this.startPoint=Rt(Xe(t)),this.ruler=new ii(this.startPoint,this.startPoint,3,this.$store.state.game.rulerColour),this.text=new Ze(this.startPoint.clone(),"","bold 20px serif"),this.ruler.owners.push(this.username),this.text.owners.push(this.username),e.addShape(this.ruler,!0,!0),e.addShape(this.text,!0,!0)):console.log("No draw layer!")},onMouseMove(t){if(!this.active||null===this.ruler||null===this.startPoint||null===this.text)return;const e=te.getLayer("draw");if(void 0===e)return void console.log("No draw layer!");const i=Rt(Xe(t));this.ruler.endPoint=i,_t.emit("Shape.Update",{shape:this.ruler.asDict(),redraw:!0,temporary:!0});const s=Math.sign(i.x-this.startPoint.x)*Math.sign(i.y-this.startPoint.y),o=Math.abs(i.x-this.startPoint.x),n=Math.abs(i.y-this.startPoint.y),a=Math.round(Math.sqrt(Math.pow(o,2)+Math.pow(n,2))*this.unitSize/this.gridSize)+" ft",r=Math.atan2(s*n,o),l=Math.min(this.startPoint.x,i.x)+o/2,c=Math.min(this.startPoint.y,i.y)+n/2;this.text.refPoint.x=l,this.text.refPoint.y=c,this.text.text=a,this.text.angle=r,_t.emit("Shape.Update",{shape:this.text.asDict(),redraw:!0,temporary:!0}),e.invalidate(!0)},onMouseUp(t){if(!this.active||null===this.ruler||null===this.startPoint||null===this.text)return;const e=te.getLayer("draw");void 0!==e?(this.active=!1,e.removeShape(this.ruler,!0,!0),e.removeShape(this.text,!0,!0),e.invalidate(!0),this.ruler=this.startPoint=this.text=null):console.log("No active layer!")}}}),Qi=Ki,ts=Object(a["a"])(Qi,Ji,Zi,!1,null,null,null);ts.options.__file="ruler.vue";var es=ts.exports,is=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ContextMenu",{ref:"selectcontext"})},ss=[],os=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("contextmenu",{attrs:{visible:t.visible,left:t.x+"px",top:t.y+"px"},on:{close:t.close}},[t.IS_DM?i("li",{on:{click:t.bringPlayers}},[t._v("Bring players")]):t._e(),i("li",{on:{click:t.createToken}},[t._v("Create basic token")]),i("li",{on:{click:t.showInitiative}},[t._v("Show initiative")])])},ns=[],as=s["default"].component("select-context",{components:{contextmenu:mi},data:()=>({visible:!1,x:0,y:0}),computed:Object.assign({},Object(_["c"])("game",["IS_DM"])),methods:{open(t){this.visible=!0,this.x=t.pageX,this.y=t.pageY,this.$nextTick(()=>this.$children[0].$el.focus())},close(){this.visible=!1},bringPlayers(){this.IS_DM&&(_t.emit("Players.Bring",{x:Ut(this.x),y:Et(this.y)}),this.close())},createToken(){this.$parent.$parent.$refs.createtokendialog.open(this.x,this.y),this.close()},showInitiative(){this.$root.$refs.initiative.visible=!0,this.close()}}}),rs=as,ls=(i("b198"),Object(a["a"])(rs,os,ns,!1,null,"9e129ee8",null));ls.options.__file="selectcontext.vue";var cs,us=ls.exports;(function(t){t[t["Noop"]=0]="Noop",t[t["Resize"]=1]="Resize",t[t["Drag"]=2]="Drag",t[t["GroupSelect"]=3]="GroupSelect"})(cs||(cs={}));var hs=zi.extend({components:{ContextMenu:us},data(){const t=new dt(-1e3,-1e3);return{name:"Select",showContextMenu:!1,mode:cs.Noop,resizeDirection:"",deltaChanged:!1,dragRay:new mt(new pt(0,0),new ft(0,0)),selectionStartPoint:t,selectionHelper:new Je(t,0,0)}},computed:{username(){return this.$store.state.game.username},zoomFactor(){return this.$store.state.game.zoomFactor},IS_DM(){return this.$store.state.game.IS_DM},useGrid(){return this.$store.state.game.useGrid}},created(){this.selectionHelper.globalCompositeOperation="source-over"},methods:{onMouseDown(t){const e=te.getLayer();if(void 0===e)return void console.log("No active layer!");this.selectionHelper.owners.includes(this.username)||this.selectionHelper.owners.push(this.username);const i=Xe(t),s=Rt(i);let o,n=!1;o=e.selection.length?e.shapes.concat(e.selection):e.shapes;for(let a=o.length-1;a>=0;a--){const t=o[a];if(!t.ownedBy())continue;const r=t.getBoundingBox().getCorner(s);if(void 0!==r){e.selection=[t],Ms.$refs.selectionInfo.shape=t,this.mode=cs.Resize,this.resizeDirection=r,e.invalidate(!0),n=!0;break}if(t.contains(s)){const s=t;-1===e.selection.indexOf(s)&&(e.selection=[s],Ms.$refs.selectionInfo.shape=s),this.mode=cs.Drag;const o=Dt(s.refPoint);this.dragRay=new mt(o,i.subtract(o)),e.invalidate(!0),n=!0;break}}if(!n){this.mode=cs.GroupSelect;for(const t of e.selection)Ms.$refs.selectionInfo.shape=t;this.selectionStartPoint=s,this.selectionHelper.refPoint=this.selectionStartPoint,this.selectionHelper.w=0,this.selectionHelper.h=0,e.selection=[this.selectionHelper],e.invalidate(!0)}},onMouseMove(t){const e=te.getLayer();if(void 0===e)return void console.log("No active layer!");const i=Xe(t),s=Rt(i);if(this.deltaChanged=!1,this.mode===cs.GroupSelect){const t=s;this.selectionHelper.w=Math.abs(t.x-this.selectionStartPoint.x),this.selectionHelper.h=Math.abs(t.y-this.selectionStartPoint.y),this.selectionHelper.refPoint=new dt(Math.min(this.selectionStartPoint.x,t.x),Math.min(this.selectionStartPoint.y,t.y)),e.invalidate(!0)}else if(e.selection.length){const o=Dt(e.selection[e.selection.length-1].refPoint),n=o.add(this.dragRay.direction);let a=i.subtract(n).multiply(1/this.zoomFactor);const r=a;if(this.mode===cs.Drag){if("tokens"===e.name&&(!t.shiftKey||!this.IS_DM))for(const t of e.selection)t.uuid!==this.selectionHelper.uuid&&(a=Jt(a,t),a!==r&&(this.deltaChanged=!0));for(const t of e.selection)t.refPoint=t.refPoint.add(a),t!==this.selectionHelper&&(t.visionObstruction&&Vt.recalculateBV(),_t.emit("Shape.Update",{shape:t.asDict(),redraw:!0,temporary:!0}));e.invalidate(!1)}else if(this.mode===cs.Resize)for(const t of e.selection)t.resize(this.resizeDirection,i),t!==this.selectionHelper&&(t.visionObstruction&&Vt.recalculateBV(),_t.emit("Shape.Update",{shape:t.asDict(),redraw:!0,temporary:!0})),e.invalidate(!1);else for(const t of e.selection){const e=t.getBoundingBox(),i=s;e.inCorner(i,"nw")?document.body.style.cursor="nw-resize":e.inCorner(i,"ne")?document.body.style.cursor="ne-resize":e.inCorner(i,"se")?document.body.style.cursor="se-resize":e.inCorner(i,"sw")?document.body.style.cursor="sw-resize":document.body.style.cursor="default"}}else document.body.style.cursor="default"},onMouseUp(t){if(void 0===te.getLayer())return void console.log("No active layer!");const e=te.getLayer();this.mode===cs.GroupSelect?(e.clearSelection(),e.shapes.forEach(t=>{if(t===this.selectionHelper)return;const i=t.getBoundingBox();t.ownedBy()&&this.selectionHelper.refPoint.x<=i.topRight.x&&this.selectionHelper.refPoint.x+this.selectionHelper.w>=i.topLeft.x&&this.selectionHelper.refPoint.y<=i.botLeft.y&&this.selectionHelper.refPoint.y+this.selectionHelper.h>=i.topLeft.y&&e.selection.push(t)}),e.selection.length>0&&e.selection.push(this.selectionHelper),e.invalidate(!0)):e.selection.length&&e.selection.forEach(i=>{if(this.mode===cs.Drag){if(this.dragRay.origin.x===zt(i.refPoint.x)&&this.dragRay.origin.y===Tt(i.refPoint.y))return;!this.useGrid||t.altKey||this.deltaChanged||i.snapToGrid(),i!==this.selectionHelper&&(i.visionObstruction&&Vt.recalculateBV(),_t.emit("Shape.Update",{shape:i.asDict(),redraw:!0,temporary:!1})),e.invalidate(!1)}this.mode===cs.Resize&&(this.useGrid&&!t.altKey&&i.resizeToGrid(),i!==this.selectionHelper&&(i.visionObstruction&&Vt.recalculateBV(),_t.emit("Shape.Update",{shape:i.asDict(),redraw:!0,temporary:!1})),e.invalidate(!1))}),this.mode=cs.Noop},onContextMenu(t){if(void 0===te.getLayer())return void console.log("No active layer!");const e=te.getLayer(),i=Xe(t),s=Rt(i);for(const o of e.selection)if(o.contains(s))return e.selection=[o],Ms.$refs.selectionInfo.shape=o,e.invalidate(!0),void this.$parent.$refs.shapecontext.open(t,o);this.$refs.selectcontext.open(t)}}}),ds=hs,ps=Object(a["a"])(ds,is,ss,!1,null,null,null);ps.options.__file="select.vue";var fs=ps.exports,ms=s["default"].component("tools",{components:{"select-tool":fs,"pan-tool":qi,"draw-tool":Bi,"ruler-tool":es,"map-tool":Gi,"shape-menu":wi,"createtoken-dialog":ki},data:()=>({currentTool:"Select",tools:["Select","Pan","Draw","Ruler","Map"],dmTools:["Map"]}),watch:{currentTool(t,e){this.$emit("tools-select-change",t,e)}},computed:{IS_DM(){return this.$store.state.game.IS_DM},currentToolComponent(){return`${this.currentTool.toLowerCase()}-tool`}},methods:{mousedown(t){if("CANVAS"!==t.target.tagName)return;let e=this.currentTool;if(1===t.button)e="Pan";else if(0!==t.button)return;this.$emit("mousedown",t,e)},mouseup(t){if("CANVAS"!==t.target.tagName)return;let e=this.currentTool;if(1===t.button)e="Pan";else if(0!==t.button)return;this.$emit("mouseup",t,e)},mousemove(t){if("CANVAS"!==t.target.tagName)return;let e=this.currentTool;if(0!==(4&t.buttons))e="Pan";else if((1&t.button)>1)return;this.$emit("mousemove",t,e);let i=!1;for(const s of Vt.annotations)if(te.UUIDMap.has(s)&&te.hasLayer("draw")){const e=te.UUIDMap.get(s);e.contains(Rt(Xe(t)))&&(i=!0,ri.annotationManager.setActiveText(e.annotation))}!i&&ri.annotationManager.shown&&ri.annotationManager.setActiveText("")},mouseleave(t){0!==(1&t.buttons)&&this.$emit("mouseup",t,this.currentTool)},contextmenu(t){"CANVAS"===t.target.tagName&&2===t.button&&"CANVAS"===t.target.tagName&&this.$emit("contextmenu",t,this.currentTool)}}}),vs=ms,gs=(i("239b"),Object(a["a"])(vs,Ve,Ye,!1,null,"69cbb9be",null));gs.options.__file="tools.vue";var ys=gs.exports;class ws{}ws.angleSteps=4,ws.drawAngleLines=!1,ws.drawFirstLightHit=!1,ws.skipPlayerFOW=!1,ws.skipLightFOW=!1,ws.tempFill="fog";var xs=ws;class bs{constructor(t,e){this.selectable=!1,this.playerEditable=!1,this.isVisionLayer=!1,this.valid=!1,this.shapes=[],this.selection=[],this.selectionColor="#CC0000",this.selectionWidth=2,this.canvas=t,this.name=e,this.width=t.width,this.height=t.height,this.ctx=t.getContext("2d")}invalidate(t){this.valid=!1,t||te.invalidateLight()}addShape(t,e,i){void 0===i&&(i=!1),t.layer=this.name,this.shapes.push(t),te.UUIDMap.set(t.uuid,t),t.checkVisionSources(),t.setMovementBlock(t.movementObstruction),t.ownedBy(Vt.username)&&t.isToken&&Vt.ownedtokens.push(t.uuid),t.annotation.length&&Vt.annotations.push(t.uuid),e&&_t.emit("Shape.Add",{shape:t.asDict(),temporary:i}),this.invalidate(!e)}setShapes(t){for(const e of t){const t=oi(e);if(void 0===t)return void console.log(`Shape with unknown type ${e.type_} could not be added`);this.addShape(t,!1,!1)}this.clearSelection(),this.invalidate(!1)}removeShape(t,e,i){void 0===i&&(i=!1),this.shapes.splice(this.shapes.indexOf(t),1),e&&_t.emit("Shape.Remove",{shape:t,temporary:i});const s=Vt.visionSources.findIndex(e=>e.shape===t.uuid),o=Vt.visionBlockers.findIndex(e=>e===t.uuid),n=Vt.movementblockers.findIndex(e=>e===t.uuid),a=Vt.annotations.findIndex(e=>e===t.uuid);s>=0&&Vt.visionSources.splice(s,1),o>=0&&Vt.visionBlockers.splice(o,1),n>=0&&Vt.movementblockers.splice(n,1),a>=0&&Vt.annotations.splice(a,1);const r=Vt.annotations.indexOf(t.uuid);r>=0&&Vt.annotations.splice(r,1);const l=Vt.ownedtokens.indexOf(t.uuid);l>=0&&Vt.ownedtokens.splice(l,1),te.UUIDMap.delete(t.uuid);const c=this.selection.indexOf(t);c>=0&&this.selection.splice(c,1),o>=0&&Vt.recalculateBV(),this.invalidate(!e)}clear(){this.ctx.clearRect(0,0,this.width,this.height)}clearSelection(){this.selection=[],Ot("selectionInfo").shape=null}draw(t){if(!this.valid){const e=this.ctx,i=e.globalCompositeOperation;t=void 0===t||t,t&&this.clear();const s=this;if(this.shapes.forEach(t=>{t.options.has("skipDraw")&&t.options.get("skipDraw")||void 0!==te.getLayer()&&t.visibleInCanvas(s.canvas)&&("fow"===s.name&&t.visionObstruction&&te.getLayer().name!==s.name||t.drawAuras(e))}),this.shapes.forEach(t=>{t.options.has("skipDraw")&&t.options.get("skipDraw")||void 0!==te.getLayer()&&t.visibleInCanvas(s.canvas)&&("fow"===s.name&&t.visionObstruction&&te.getLayer().name!==s.name||t.draw(e))}),null!=this.selection){e.fillStyle=this.selectionColor,e.strokeStyle=this.selectionColor,e.lineWidth=this.selectionWidth;const t=Vt.zoomFactor;this.selection.forEach(i=>{e.globalCompositeOperation=i.globalCompositeOperation;const s=i.getBoundingBox();e.strokeRect(zt(s.topLeft.x),Tt(s.topLeft.y),s.w*t,s.h*t);const o=Math.min(6,s.w/2);e.fillRect(zt(s.topRight.x-o/2),Tt(s.topLeft.y-o/2),o*t,o*t),e.fillRect(zt(s.topLeft.x-o/2),Tt(s.topLeft.y-o/2),o*t,o*t),e.fillRect(zt(s.topRight.x-o/2),Tt(s.botLeft.y-o/2),o*t,o*t),e.fillRect(zt(s.topLeft.x-o/2),Tt(s.botLeft.y-o/2),o*t,o*t)})}e.globalCompositeOperation=i,this.valid=!0}}moveShapeOrder(t,e,i){const s=this.shapes.indexOf(t);s!==e&&(this.shapes.splice(s,1),this.shapes.splice(e,0,t),i&&_t.emit("Shape.Order.Set",{shape:t.asDict(),index:e}),this.invalidate(!0))}onShapeMove(t){t.checkVisionSources(),t.visionObstruction&&Vt.recalculateBV(),this.invalidate(!1)}}class Ss extends bs{constructor(){super(...arguments),this.isVisionLayer=!0,this.preFogShapes=[]}addShape(t,e,i){super.addShape(t,e,i),t.options.has("preFogShape")&&t.options.get("preFogShape")&&this.preFogShapes.push(t)}removeShape(t,e,i){if(t.options.has("preFogShape")&&t.options.get("preFogShape")){const e=this.preFogShapes.findIndex(e=>e.uuid===t.uuid);this.preFogShapes.splice(e,1)}super.removeShape(t,e,i)}draw(){if(!this.valid){const t=this.ctx;if(xs.skipLightFOW)return t.clearRect(0,0,this.canvas.width,this.canvas.height),void(this.valid=!0);const e=t.globalCompositeOperation;t.clearRect(0,0,this.canvas.width,this.canvas.height),t.fillStyle="rgba(0, 0, 0, 1)";const i=te.getLayer("draw").ctx;(xs.drawAngleLines||xs.drawFirstLightHit)&&i.clearRect(0,0,i.canvas.width,i.canvas.height),Vt.fullFOW&&te.hasLayer("tokens")&&te.getLayer("tokens").shapes.forEach(e=>{if(!e.ownedBy()||!e.isToken)return;const i=e.getBoundingBox(),s=Dt(e.center()),o=.8*At(i.w);t.beginPath(),t.arc(s.x,s.y,o,0,2*Math.PI);const n=t.createRadialGradient(s.x,s.y,o/2,s.x,s.y,o);n.addColorStop(0,"rgba(0, 0, 0, 1)"),n.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=n,t.fill()});for(const s of Vt.visionSources){const e=te.UUIDMap.get(s.shape);if(void 0===e)continue;const o=e.auras.find(t=>t.uuid===s.aura);if(void 0===o)continue;const n=Nt(o.value+o.dim),a=e.center(),r=Dt(a),l=new ti(a,n);if(!l.visibleInCanvas(t.canvas))continue;let c=-1;const u=new Path2D;let h;u.moveTo(r.x,r.y);for(let s=0;s<2*Math.PI;s+=xs.angleSteps/180*Math.PI){const e=new dt(a.x+n*Math.cos(s),a.y+n*Math.sin(s));xs.drawAngleLines&&(i.beginPath(),i.moveTo(zt(a.x),Tt(a.y)),i.lineTo(zt(e.x),Tt(e.y)),i.stroke());const l=mt.fromPoints(a,e),d=Vt.BV.intersect(l);if(0===s&&(h=d.hit?d.intersect:e),d.hit)-1!==c&&(u.arc(r.x,r.y,Bt(o.value+o.dim),c,s),c=-1),u.lineTo(zt(d.intersect.x),Tt(d.intersect.y));else if(-1===c){c=s;const i=Dt(e);t.lineTo(i.x,i.y)}}if(-1===c?u.lineTo(zt(h.x),Tt(h.y)):u.arc(r.x,r.y,Bt(o.value+o.dim),c,2*Math.PI),Vt.fullFOW){if(o.dim>0){const e=t.createRadialGradient(r.x,r.y,Bt(o.value),r.x,r.y,Bt(o.value+o.dim));e.addColorStop(0,"rgba(0, 0, 0, 1)"),e.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=e}else t.fillStyle="rgba(0, 0, 0, 1)";t.fill(u)}o.lastPath=u}Vt.fowLOS&&(t.globalCompositeOperation="source-in",t.drawImage(te.getLayer("fow-players").canvas,0,0));for(const s of this.preFogShapes){if(!s.visibleInCanvas(this.canvas))continue;const e=s.globalCompositeOperation;Vt.fullFOW||("source-over"===s.globalCompositeOperation?s.globalCompositeOperation="destination-out":"destination-out"===s.globalCompositeOperation&&(s.globalCompositeOperation="source-over")),s.draw(t),s.globalCompositeOperation=e}Vt.fullFOW&&(t.globalCompositeOperation="source-out",t.fillStyle=qe(),t.fillRect(0,0,t.canvas.width,t.canvas.height)),super.draw(!1),t.globalCompositeOperation=e}}}class _s extends bs{constructor(){super(...arguments),this.isVisionLayer=!0}draw(){if(!this.valid){const t=this.ctx;if(!Vt.fowLOS||xs.skipPlayerFOW)return t.clearRect(0,0,this.canvas.width,this.canvas.height),void(this.valid=!0);t.clearRect(0,0,this.canvas.width,this.canvas.height);const e=t.globalCompositeOperation;t.fillStyle="rgba(0, 0, 0, 1)",Vt.IS_DM||super.draw(!Vt.fullFOW);const i=t.canvas.width+t.canvas.height;for(const s of Vt.ownedtokens){t.beginPath();let e=-1;const o=te.UUIDMap.get(s);if(void 0===o)continue;const n=o.center(),a=Dt(n);for(let s=0;s<2*Math.PI;s+=xs.angleSteps/2/180*Math.PI){const o=Math.cos(s),r=Math.sin(s),l=new mt(n,new ft(o,r)),c=Vt.BV.intersect(l);c.hit?(-1!==e&&(t.arc(a.x,a.y,i,e,s),e=-1),t.lineTo(zt(c.intersect.x),Tt(c.intersect.y))):-1===e&&(t.lineTo(a.x+i*o,a.y+i*r),e=s)}-1!==e?t.arc(a.x,a.y,i,e,2*Math.PI):t.closePath(),t.fill()}Vt.IS_DM&&super.draw(!Vt.fullFOW),t.globalCompositeOperation=e}}}class Cs extends bs{invalidate(){this.valid=!1}draw(t){this.valid||this.drawGrid()}drawGrid(){const t=this.ctx;this.clear(),t.beginPath();const e=Vt.gridSize;for(let i=0;i<this.width;i+=e*Vt.zoomFactor)t.moveTo(i+Vt.panX%e*Vt.zoomFactor,0),t.lineTo(i+Vt.panX%e*Vt.zoomFactor,this.height),t.moveTo(0,i+Vt.panY%e*Vt.zoomFactor),t.lineTo(this.width,i+Vt.panY%e*Vt.zoomFactor);t.strokeStyle=Vt.gridColour,t.lineWidth=1,t.stroke(),this.valid=!0}}function ks(t){const e=document.createElement("canvas");let i;e.style.zIndex=te.layers.length.toString(),e.width=window.innerWidth,e.height=window.innerHeight,i="grid"===t.type_?new Cs(e,t.name):"fow"===t.type_?new Ss(e,t.name):"fow-players"===t.type_?new _s(e,t.name):new bs(e,t.name),i.selectable=t.selectable,i.playerEditable=t.player_editable,te.addLayer(i);const s=document.getElementById("layers");null!==s?("fow-players"!==t.name&&s.appendChild(e),i.setShapes(t.shapes)):console.warn("Layers div is missing, this will prevent the main game board from loading!")}_t.on("connect",()=>{console.log("Connected")}),_t.on("disconnect",()=>{console.log("Disconnected")}),_t.on("redirect",t=>{console.log("redirecting"),window.location.href=t}),_t.on("Room.Info.Set",t=>{Vt.setRoomName(t.name),Vt.setRoomCreator(t.creator),Vt.setInvitationCode(t.invitationCode)}),_t.on("Username.Set",t=>{Vt.setUsername(t),Vt.setDM(!0)}),_t.on("Client.Options.Set",t=>{Vt.setGridColour(t.grid_colour,!1),Vt.setFOWColour(t.fow_colour,!1),Vt.setRulerColour(t.ruler_colour,!1),Vt.setPanX(t.pan_x),Vt.setPanY(t.pan_y),Vt.setZoomFactor(t.zoom_factor),t.active_layer&&te.selectLayer(t.active_layer,!1),void 0!==te.getGridLayer()&&te.getGridLayer().invalidate()}),_t.on("Location.Set",t=>{void 0!==t.name&&Vt.setLocationName(t.name),void 0!==t.unit_size&&Vt.setUnitSize(t.unit_size,!1),void 0!==t.use_grid&&Vt.setUseGrid(t.use_grid,!1),void 0!==t.full_fow&&Vt.setFullFOW(t.full_fow,!1),void 0!==t.fow_opacity&&Vt.setFOWOpacity(t.fow_opacity,!1),void 0!==t.fow_los&&Vt.setLineOfSight(t.fow_los,!1)}),_t.on("Position.Set",t=>{ri.setCenterPosition(new dt(t.x,t.y))}),_t.on("Notes.Set",t=>{for(const e of t)Vt.newNote(e,!1)}),_t.on("Asset.List.Set",t=>{Vt.setAssets(t)}),_t.on("Board.Set",t=>{Vt.clear(),Vt.setLocations(t.locations),document.getElementById("layers").innerHTML="",Vt.resetLayerInfo();for(const e of t.layers)ks(e);te.selectLayer(te.getLayer().name,!1),Ot("initiative").clear(),Vt.setBoardInitialized(!0),Vt.recalculateBV()}),_t.on("Gridsize.Set",t=>{Vt.setGridSize(t,!1)}),_t.on("Shape.Add",t=>{ri.addShape(t)}),_t.on("Shape.Remove",t=>{if(!te.UUIDMap.has(t.uuid))return void console.log("Attempted to remove an unknown shape");if(!te.hasLayer(t.layer))return void console.log(`Attempted to remove shape from an unknown layer ${t.layer}`);const e=te.getLayer(t.layer);e.removeShape(te.UUIDMap.get(t.uuid),!1),e.invalidate(!1)}),_t.on("Shape.Order.Set",t=>{if(!te.UUIDMap.has(t.shape.uuid))return void console.log("Attempted to move the shape order of an unknown shape");if(!te.hasLayer(t.shape.layer))return void console.log(`Attempted to remove shape from an unknown layer ${t.shape.layer}`);const e=te.UUIDMap.get(t.shape.uuid),i=te.getLayer(e.layer);i.moveShapeOrder(e,t.index,!1)}),_t.on("Shape.Layer.Change",t=>{const e=te.UUIDMap.get(t.uuid);void 0!==e&&e.moveLayer(t.layer,!1)}),_t.on("Shape.Update",t=>{ri.updateShape(t)}),_t.on("Initiative.Set",t=>{Ot("initiative").data=t.filter(t=>!!t)}),_t.on("Initiative.Turn.Update",t=>{Ot("initiative").setTurn(t,!1)}),_t.on("Initiative.Round.Update",t=>{Ot("initiative").setRound(t,!1)}),_t.on("Initiative.Effect.New",t=>{const e=Ot("initiative"),i=e.getActor(t.actor);void 0!==i&&e.createEffect(i,t.effect,!1)}),_t.on("Initiative.Effect.Update",t=>{Ot("initiative").updateEffect(t.actor,t.effect,!1)}),_t.on("Temp.Clear",t=>{t.forEach(t=>{if(!te.UUIDMap.has(t.uuid))return void console.log("Attempted to remove an unknown temporary shape");if(!te.hasLayer(t.layer))return void console.log(`Attempted to remove shape from an unknown layer ${t.layer}`);const e=te.UUIDMap.get(t.uuid);te.getLayer(t.layer).removeShape(e,!1)})});var Ps=s["default"].component("game",{components:{"tool-bar":ys,"selection-info":je,"prompt-dialog":ut,"confirm-dialog":ot,"menu-bar":Le,"initiative-dialog":le,"zoom-slider":V.a,"note-dialog":ze},data:()=>({ready:{manager:!1,tools:!1}}),computed:Object.assign({},Object(_["c"])("game",["IS_DM","layers"]),Object(_["b"])("game",["selectedLayer"]),{gridSize(){return this.$store.state.game.gridSize},zoomFactor:{get(){return Vt.zoomFactor},set(t){Vt.updateZoom(t,Rt(new pt(window.innerWidth/2,window.innerHeight/2)))}}}),beforeRouteEnter(t,e,i){St(t),i()},mounted(){this.ready.manager=!0},methods:{mousedown(t){this.$refs.tools.mousedown(t)},mouseup(t){this.$refs.tools.mouseup(t)},mousemove(t){this.$refs.tools.mousemove(t)},mouseleave(t){this.$refs.tools.mouseleave(t)},contextmenu(t){this.$refs.tools.contextmenu(t)},selectLayer(t){te.selectLayer(t)},drop(t){if(null!==t&&null!==t.dataTransfer)if(t.dataTransfer.files.length>0)this.$refs.confirm.open("Uploading files should be done through the asset manager.","Ok","").then(()=>{},()=>{});else{if(""===t.dataTransfer.getData("text/plain"))return;te.dropAsset(t)}}}}),Ls=Ps,Os=(i("561b"),Object(a["a"])(Ls,G,W,!1,null,null,null));Os.options.__file="game.vue";var Ms=Os.exports;s["default"].use(d["a"]);const $s=new d["a"]({mode:"history",base:"/",routes:[{path:"/",redirect:"/dashboard"},{path:"/_load",name:"load",component:D},{path:"/auth",component:{template:"<router-view></router-view>"},children:[{path:"login",component:S},{path:"logout",component:P}]},{path:"/dashboard",component:H,meta:{auth:!0}},{path:"/game/:creator/:room",component:Ms,meta:{auth:!0}}]});$s.beforeEach((t,e,i)=>{A.initialized||"/_load"===t.path?t.matched.some(t=>t.meta.auth)&&!A.authenticated?i({path:"/auth/login",query:{redirect:t.path}}):i():(i({path:"/_load"}),h.a.get("/api/auth").then(t=>{t.data.auth&&A.setAuthenticated(!0),A.setInitialized(!0),$s.push("/dashboard")}).catch(()=>{console.log(0)}))});var Is=$s;s["default"].config.productionTip=!1;const Ds=new s["default"]({router:Is,store:C,render:t=>t(c)}).$mount("#app");window.app=Ds;var zs=e["default"]=Ds},d45f:function(t,e,i){"use strict";var s=i("dc8d"),o=i.n(s);o.a},d8a6:function(t,e,i){"use strict";var s=i("2c85"),o=i.n(s);o.a},dc8d:function(t,e,i){},e5a8:function(t,e,i){"use strict";var s=i("492e"),o=i.n(s);o.a},ee6a:function(t,e,i){"use strict";var s=i("5552"),o=i.n(s);o.a},ef01:function(t,e,i){},fe11:function(t,e,i){},fe78:function(t,e,i){"use strict";var s=i("b346"),o=i.n(s);o.a},ff44:function(t,e,i){}});
//# sourceMappingURL=app.04bd4cd3.js.map